<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/png" href="/blogs/icon.png"><meta name="generator" content="Astro v5.16.6"><!-- Fonts --><!-- Font styles --><!-- Preload font files --><link rel="preload" href="/blogs/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/blogs/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://laudantstolam.github.io/blogs/flareon2025/"><!-- Primary Meta Tags --><title>Flare-on 2025 Writeup</title><meta name="title" content="Flare-on 2025 Writeup"><meta name="description" content="æˆ‘å¥½èœä¸æœƒé€†å‘QQ"><meta name="keywords" content="writeup, reverse"><!-- Robots Meta Tags --><!-- Open Graph / Facebook --><meta property="og:type" content="article"><meta property="og:url" content="https://laudantstolam.github.io/blogs/flareon2025/"><meta property="og:title" content="Flare-on 2025 Writeup"><meta property="og:description" content="æˆ‘å¥½èœä¸æœƒé€†å‘QQ"><meta property="og:image" content="https://laudantstolam.github.io/blogs/flareon2025/null"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://laudantstolam.github.io/blogs/flareon2025/"><meta property="twitter:title" content="Flare-on 2025 Writeup"><meta property="twitter:description" content="æˆ‘å¥½èœä¸æœƒé€†å‘QQ"><meta property="twitter:image" content="https://laudantstolam.github.io/blogs/flareon2025/null"><!-- KaTeX CSS for LaTeX rendering --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"><link rel="stylesheet" href="/blogs/_astro/_slug_.xWQ6d_73.css">
<link rel="stylesheet" href="/blogs/_astro/_slug_.CxGNqR4v.css">
<link rel="stylesheet" href="/blogs/_astro/_slug_.k20Gn5Lx.css"></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <div class="nav-wrapper" data-astro-cid-3ef6ksr2> <!-- <div class="nav-brand">
				<a href={getUrl('/')} class="brand-link">
					<div class="brand-icon">
						<img src={getUrl('/icon.png')} alt="icon logo" width="24" height="24" />
					</div>
					<span class="brand-text">{SITE_TITLE}</span>
				</a>
			</div> --> <div class="nav-links" data-astro-cid-3ef6ksr2> <a href="/blogs/" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Home </a>  <a href="/blogs/blog" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Blog </a>  <a href="/blogs/projects" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Projects </a>  </div> <div class="nav-actions" data-astro-cid-3ef6ksr2> <button id="theme-toggle" class="theme-toggle" title="Toggle theme" aria-label="Toggle theme" data-astro-cid-x3pjskd3> <svg width="20" height="20" viewBox="0 0 24 24" class="sun-icon" data-astro-cid-x3pjskd3> <path fill="currentColor" d="M12 18C8.68629 18 6 15.3137 6 12C6 8.68629 8.68629 6 12 6C15.3137 6 18 8.68629 18 12C18 15.3137 15.3137 18 12 18ZM12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16ZM11 1H13V4H11V1ZM11 20H13V23H11V20ZM3.51472 4.92893L4.92893 3.51472L7.05025 5.63604L5.63604 7.05025L3.51472 4.92893ZM16.9497 18.364L18.364 16.9497L20.4853 19.0711L19.0711 20.4853L16.9497 18.364ZM19.0711 3.51472L20.4853 4.92893L18.364 7.05025L16.9497 5.63604L19.0711 3.51472ZM5.63604 16.9497L7.05025 18.364L4.92893 20.4853L3.51472 19.0711L5.63604 16.9497ZM23 11V13H20V11H23ZM4 11V13H1V11H4Z" data-astro-cid-x3pjskd3></path> </svg> <svg width="20" height="20" viewBox="0 0 24 24" class="moon-icon" data-astro-cid-x3pjskd3> <path fill="currentColor" d="M10 7C10 10.866 13.134 14 17 14C18.9584 14 20.729 13.1957 21.9995 11.8995C22 11.933 22 11.9665 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C12.0335 2 12.067 2 12.1005 2.00049C10.8043 3.27098 10 5.04157 10 7ZM4 12C4 16.4183 7.58172 20 12 20C15.0583 20 17.7158 18.2839 19.062 15.7621C18.3945 15.9187 17.7035 16 17 16C12.0294 16 8 11.9706 8 7C8 6.29648 8.08133 5.60547 8.2379 4.938C5.71611 6.28423 4 8.94174 4 12Z" data-astro-cid-x3pjskd3></path> </svg> </button>  <script type="module">const m=document.getElementById("theme-toggle");function t(e){document.documentElement.setAttribute("data-theme",e),localStorage.setItem("theme",e)}function o(){const n=(document.documentElement.getAttribute("data-theme")||"dark")==="light"?"dark":"light";t(n)}function d(){const e=localStorage.getItem("theme");t(e||"dark")}m?.addEventListener("click",o);document.addEventListener("DOMContentLoaded",d);window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{localStorage.getItem("theme")||t("dark")});</script> <a href="https://github.com/laudantstolam" target="_blank" class="social-link" aria-label="GitHub" data-astro-cid-3ef6ksr2> <svg viewBox="0 0 16 16" aria-hidden="true" data-astro-cid-3ef6ksr2> <path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-3ef6ksr2></path> </svg> </a> </div> </div> </nav> </header>  <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2025-10-26T00:00:00.000Z"> Oct 26, 2025 </time>  </div> <h1 data-astro-cid-bvzihdzo>Flare-on 2025 Writeup</h1>  <div class="tags" data-astro-cid-bvzihdzo> <a href="/blogs/tag/writeup/" class="tag" data-astro-cid-bvzihdzo>#writeup</a><a href="/blogs/tag/reverse/" class="tag" data-astro-cid-bvzihdzo>#reverse</a> </div>  </div> <!-- Table of Contents --> <aside class="toc-wrapper" id="toc-wrapper" data-astro-cid-bvzihdzo> <div class="toc-header" data-astro-cid-bvzihdzo> <div class="toc-title" data-astro-cid-bvzihdzo> <span data-astro-cid-bvzihdzo>ğŸ‘€</span> <button class="toc-minimize-btn" id="toc-minimize-btn" aria-label="Toggle TOC" data-astro-cid-bvzihdzo> <span id="toc-icon" data-astro-cid-bvzihdzo>âˆ’</span> </button> </div> </div> <div class="toc-content" data-astro-cid-bvzihdzo> <ul class="toc-list" id="toc-list" data-astro-cid-bvzihdzo></ul> </div> </aside>  




















<table><thead><tr><th align="left"><font color="#c0504d">total</font></th><th align="left">Reverse</th><th align="left">Pwn</th><th align="left">Web</th><th align="left">Crypto</th><th align="left">Misc/Forensic</th></tr></thead><tbody><tr><td align="left"></td><td align="left">V</td><td align="left"></td><td align="left"></td><td align="left"></td><td align="left"></td></tr></tbody></table>



























































<table><thead><tr><th align="left">challenge</th><th align="left">difficulty</th><th>genere</th><th>GPT-able</th></tr></thead><tbody><tr><td align="left">01</td><td align="left">ğŸ’”</td><td>pygame</td><td>V</td></tr><tr><td align="left">02</td><td align="left">ğŸ’”</td><td>python opcode</td><td>V</td></tr><tr><td align="left">03</td><td align="left">ğŸ’”</td><td>pdf misc</td><td>V</td></tr><tr><td align="left">04</td><td align="left">ğŸ’”</td><td>header repair</td><td>0.5+é€šéˆ</td></tr><tr><td align="left">05(é€²åº¦70%)</td><td align="left">ğŸ’”ğŸ’”ğŸ’”</td><td>dbg and abs</td><td>0.2?</td></tr><tr><td align="left">06</td><td align="left">tbc</td><td></td><td></td></tr><tr><td align="left">07</td><td align="left">tbc</td><td></td><td></td></tr><tr><td align="left">08</td><td align="left">tbc</td><td></td><td></td></tr></tbody></table>
<p>ä¸Šèª²ä¸Šåˆ°ä¸€åŠè¢«autongæŠ“ä¾†æ‰“flare-on
é€™æ˜¯google secure teamæ¯å¹´æœƒå‡ºçš„CTFé¡Œç›® é«”æ„Ÿæ¯ä¸€é¡Œéƒ½æ˜¯å¯ä»¥å»¶ä¼¸ç„¶å¾Œå­¸åˆ°ä¸€äº›å¯¦ç”¨çŸ¥è­˜çš„é…·é¡Œç›®
ä»Šå¹´ç¬¬ä¸€æ¬¡æ‰“ æ„Ÿè¦ºå¾ˆæœ‰è¶£ å­¸åˆ°å¾ˆå¤šä¸ä¸€æ¨£çš„revæŠ€å·§</p>
<p><img src="https://raw.githubusercontent.com/Ash0645/image_remote/main/20251025123338.png" alt="image.png|300">
:D</p>
<h2 id="reverse">Reverse</h2>
<h3 id="01">01</h3>
<p>æ˜¯ä¸€å€‹é…·é…·Pygame, å¾€ä¸‹é‘½æœƒé‘½åˆ°flagçš„æ¦‚å¿µw</p>
<details data-callout="" data-callout-type="quote" open>
<summary data-callout-title="">challenge</summary>
<div data-callout-body="">
<p><img src="https://raw.githubusercontent.com/Ash0645/image_remote/main/20251025124037.png" alt="image.png|300"></p>
<div class="expressive-code"><link rel="stylesheet" href="/blogs/_astro/ec.0niu6.css"><script type="module" src="/blogs/_astro/ec.8zarh.js"></script><figure class="frame"><figcaption class="header"></figcaption><pre data-language="python"><code><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">def</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">GenerateFlagText</span><span style="--0:#E1E4E8;--1:#24292E">(sum):</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">key </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">sum</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">>></span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">8</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">encoded </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#79B8FF;--1:#005CC5">\xd0\xc7\xdf\xdb\xd4\xd0\xd4\xdc\xe3\xdb\xd1\xcd\x9f\xb5\xa7\xa7\xa0\xac\xa3\xb4\x88\xaf\xa6\xaa\xbe\xa8\xe3\xa0\xbe\xff\xb1\xbc\xb9</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">plaintext </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> []</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">for</span><span style="--0:#E1E4E8;--1:#24292E"> i </span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">range</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#79B8FF;--1:#005CC5">len</span><span style="--0:#E1E4E8;--1:#24292E">(encoded)):</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">       </span></span><span style="--0:#E1E4E8;--1:#24292E">plaintext.append(</span><span style="--0:#79B8FF;--1:#005CC5">chr</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">ord</span><span style="--0:#E1E4E8;--1:#24292E">(encoded[i]) </span><span style="--0:#F97583;--1:#BF3441">^</span><span style="--0:#E1E4E8;--1:#24292E"> (key</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E">i)))</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">''</span><span style="--0:#E1E4E8;--1:#24292E">.join(plaintext)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="def GenerateFlagText(sum):   key = sum >> 8   encoded = &#x22;\xd0\xc7\xdf\xdb\xd4\xd0\xd4\xdc\xe3\xdb\xd1\xcd\x9f\xb5\xa7\xa7\xa0\xac\xa3\xb4\x88\xaf\xa6\xaa\xbe\xa8\xe3\xa0\xbe\xff\xb1\xbc\xb9&#x22;   plaintext = []   for i in range(0, len(encoded)):       plaintext.append(chr(ord(encoded[i]) ^ (key+i)))   return &#x27;&#x27;.join(plaintext)"><div></div></button></div></figure></div>
<p>æœ‰å€‹é©—è­‰flagçš„funcï¼Œå‚³å…¥çš„æ±è¥¿æ˜¯æ¯æ¬¡é‘½åˆ°ç†Šçš„æ™‚å€™çš„xå€¼ (<code>Loc</code>)</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="python"><code><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> player.hitBear():</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">               </span></span><span style="--0:#E1E4E8;--1:#24292E">player.drill.retract()</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">               </span></span><span style="--0:#E1E4E8;--1:#24292E">bear_sum </span><span style="--0:#F97583;--1:#BF3441">*=</span><span style="--0:#E1E4E8;--1:#24292E"> player.x</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">               </span></span><span style="--0:#E1E4E8;--1:#24292E">bear_mode </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">True</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> bear_mode:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">screen.blit(bearimage, (player.rect.x, screen_height </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#E1E4E8;--1:#24292E"> tile_size))</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> current_level </span><span style="--0:#F97583;--1:#BF3441">==</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">len</span><span style="--0:#E1E4E8;--1:#24292E">(LevelNames) </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">and</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">not</span><span style="--0:#E1E4E8;--1:#24292E"> victory_mode:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">victory_mode </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">True</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">flag_text </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> GenerateFlagText(bear_sum)</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#79B8FF;--1:#005CC5">print</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#9ECBFF;--1:#032F62">"Your Flag: "</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> flag_text)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="if player.hitBear():               player.drill.retract()               bear_sum *= player.x               bear_mode = Trueif bear_mode:  screen.blit(bearimage, (player.rect.x, screen_height - tile_size))  if current_level == len(LevelNames) - 1 and not victory_mode:    victory_mode = True    flag_text = GenerateFlagText(bear_sum)    print(&#x22;Your Flag: &#x22; + flag_text)"><div></div></button></div></figure></div>
<p>ç†Šæœƒå‡ºç¾åœ¨<code>X=len(LevelNames[current_level])</code>çš„åœ°æ–¹
<code>LevelNames</code>åˆ†åˆ¥æ˜¯ <code>['California','Ohio','Death Valley','Mexico','The Grand Canyon']</code></p>
</div>
</details>
<details data-callout="" data-callout-type="slove" open>
<summary data-callout-title="">solution</summary>
<div data-callout-body="">
<p>æ‰€ä»¥å°±æŠŠlengthä¹˜éå»ä¸Ÿåˆ°<code>GenerateFlag</code>å°±å¥½</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="python"><code><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">## copy paste from src code</span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">def</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">GenerateFlagText</span><span style="--0:#E1E4E8;--1:#24292E">(sum_value):</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">key </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> sum_value </span><span style="--0:#F97583;--1:#BF3441">>></span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">8</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">encoded </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#79B8FF;--1:#005CC5">\xd0\xc7\xdf\xdb\xd4\xd0\xd4\xdc\xe3\xdb\xd1\xcd\x9f\xb5\xa7\xa7\xa0\xac\xa3\xb4\x88\xaf\xa6\xaa\xbe\xa8\xe3\xa0\xbe\xff\xb1\xbc\xb9</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">plaintext </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> []</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">for</span><span style="--0:#E1E4E8;--1:#24292E"> i </span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">range</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">len</span><span style="--0:#E1E4E8;--1:#24292E">(encoded)):</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">       </span></span><span style="--0:#E1E4E8;--1:#24292E">plaintext.append(</span><span style="--0:#79B8FF;--1:#005CC5">chr</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">ord</span><span style="--0:#E1E4E8;--1:#24292E">(encoded[i]) </span><span style="--0:#F97583;--1:#BF3441">^</span><span style="--0:#E1E4E8;--1:#24292E"> (key </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> i)))</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">""</span><span style="--0:#E1E4E8;--1:#24292E">.join(plaintext)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">bear_sum </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">for</span><span style="--0:#E1E4E8;--1:#24292E"> name </span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#E1E4E8;--1:#24292E"> [</span><span style="--0:#9ECBFF;--1:#032F62">"California"</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#9ECBFF;--1:#032F62">"Ohio"</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#9ECBFF;--1:#032F62">"Death Valley"</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#9ECBFF;--1:#032F62">"Mexico"</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#9ECBFF;--1:#032F62">"The Grand Canyon"</span><span style="--0:#E1E4E8;--1:#24292E">]:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">bear_sum </span><span style="--0:#F97583;--1:#BF3441">*=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">len</span><span style="--0:#E1E4E8;--1:#24292E">(name)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">print</span><span style="--0:#E1E4E8;--1:#24292E">(GenerateFlagText(bear_sum))</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="## copy paste from src codedef GenerateFlagText(sum_value):   key = sum_value >> 8   encoded = &#x22;\xd0\xc7\xdf\xdb\xd4\xd0\xd4\xdc\xe3\xdb\xd1\xcd\x9f\xb5\xa7\xa7\xa0\xac\xa3\xb4\x88\xaf\xa6\xaa\xbe\xa8\xe3\xa0\xbe\xff\xb1\xbc\xb9&#x22;   plaintext = []   for i in range(len(encoded)):       plaintext.append(chr(ord(encoded[i]) ^ (key + i)))   return &#x22;&#x22;.join(plaintext)bear_sum = 1for name in [&#x22;California&#x22;, &#x22;Ohio&#x22;, &#x22;Death Valley&#x22;, &#x22;Mexico&#x22;, &#x22;The Grand Canyon&#x22;]:   bear_sum *= len(name)print(GenerateFlagText(bear_sum))"><div></div></button></div></figure></div>
</div>
</details>
<h3 id="02">02</h3>
<p>pyc ç›¸é—œè§£å£“ç¸®</p>
<details data-callout="" data-callout-type="quote" open>
<summary data-callout-title="">challenge</summary>
<div data-callout-body="">
<p></p>
<p><code>encrypted_sequencer_data</code> -> zlibè§£å£“ -> marshelåŸ·è¡Œ
(<code>marshal</code>æ˜¯pythonç”¨ä¾†è®€å¯«<code>pyc</code>çš„å·¥å…·ï¼Œå°‡ <code>.py</code> â†’ <code>.pyc</code>ã€æˆ–é‚„åŸæˆå¯åŸ·è¡Œç‰©ä»¶)</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="python"><code><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">import</span><span style="--0:#E1E4E8;--1:#24292E"> zlib</span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">import</span><span style="--0:#E1E4E8;--1:#24292E"> marshal</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972"># These are my encrypted instructions for the Sequencer.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">encrypted_sequencer_data </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">b</span><span style="--0:#9ECBFF;--1:#032F62">'x\....'</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">print</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">f</span><span style="--0:#9ECBFF;--1:#032F62">"Booting up </span><span style="--0:#79B8FF;--1:#005CC5">{</span><span style="--0:#F97583;--1:#BF3441">f</span><span style="--0:#9ECBFF;--1:#032F62">"Project Chimera"</span><span style="--0:#79B8FF;--1:#005CC5">}</span><span style="--0:#9ECBFF;--1:#032F62"> from Dr. Khem's journal..."</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972"># Activate the Genetic Sequencer. From here, the process is automated.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">sequencer_code </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> zlib.decompress(encrypted_sequencer_data)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">### (EXTRACT sequencer_code)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">### print(sequencer_code)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">exec</span><span style="--0:#E1E4E8;--1:#24292E">(marshal.loads(sequencer_code))</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import zlibimport marshal# These are my encrypted instructions for the Sequencer.encrypted_sequencer_data = b&#x27;x\....&#x27;print(f&#x22;Booting up {f&#x22;Project Chimera&#x22;} from Dr. Khem&#x27;s journal...&#x22;)# Activate the Genetic Sequencer. From here, the process is automated.sequencer_code = zlib.decompress(encrypted_sequencer_data)### (EXTRACT sequencer_code)### print(sequencer_code)exec(marshal.loads(sequencer_code))"><div></div></button></div></figure></div>
<p>ç„¶å¾Œ <code>sequencer_code</code>çš„çµæ§‹å¦‚ä¸‹</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">(HEADER)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">b"\xe3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05\x00\x00\x00...</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">(BYTE CODE)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">c$|e+O>7&#x26;-6`m!Rzak~llE|2&#x3C;;!(^*VQn#qEH||......</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">(LOAD_CONST)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">--- Calibrating Genetic Sequencer ---....</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">(METADATA)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="(HEADER)b&#x22;\xe3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05\x00\x00\x00...(BYTE CODE)c$|e+O>7&#x26;-6&#x60;m!Rzak~llE|2<;!(^*VQn#qEH||......(LOAD_CONST)--- Calibrating Genetic Sequencer ---....(METADATA)"><div></div></button></div></figure></div>
<p>é‚£ä¸€å¤§å¨è£¡é¢æœ‰ä¸€äº›å°ç·šç´¢(<code>LOAD_CONST</code>çš„å…§å®¹)</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="pyc"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">--- Calibrating Genetic Sequencer ---</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">z\x1fDecoding catalyst DNA strand...</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">z\x1eSynthesizing Catalyst Serum...)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">\x0f\xda\x06base64</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">\xda\x04zlib</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">\xda\x07marshal</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">\xda\x05types</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">\xda\x17encoded_catalyst_strand</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">\xda\x05print</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">\xda\tb85decode</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">\xda\x13compressed_catalyst</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">\xda\ndecompress</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">\xda\x17marshalled_genetic_code</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">\xda\x05loads</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">\xda\x14catalyst_code_object</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">\xda\x0cFunctionType</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">\xda\x07globals</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">\xda\x1bcatalyst_injection_function\xa9\x00\xf3\x00\x00\x00\x00\xfa\x13&#x3C;genetic_sequencer>\xda\x08&#x3C;module></span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="--- Calibrating Genetic Sequencer ---z\x1fDecoding catalyst DNA strand...z\x1eSynthesizing Catalyst Serum...)\x0f\xda\x06base64\xda\x04zlib\xda\x07marshal\xda\x05types\xda\x17encoded_catalyst_strand\xda\x05print\xda\tb85decode\xda\x13compressed_catalyst\xda\ndecompress\xda\x17marshalled_genetic_code\xda\x05loads\xda\x14catalyst_code_object\xda\x0cFunctionType\xda\x07globals\xda\x1bcatalyst_injection_function\xa9\x00\xf3\x00\x00\x00\x00\xfa\x13<genetic_sequencer>\xda\x08<module>"><div></div></button></div></figure></div>
<p>é‚è¼¯çœ‹èµ·ä¾†æ˜¯<code>base64</code>-> <code>zlib</code>-><code>marshal</code>-><code>encoded_catalyst_strand()</code> -> <code>base85</code> -> <code>zlib</code> -> <code>marshal</code>
((è£œå……ä¸€ä¸‹<code>types.FunctionType</code>æ˜¯ç”¨ä¾†å°‡ code object åŒ…è£æˆ callable å‡½æ•¸))</p>
</div>
</details>
<details data-callout="" data-callout-type="slove" open>
<summary data-callout-title="">solution</summary>
<div data-callout-body="">
<p>é€†æ¨å›å»ï¼Œå…ˆæ˜¯ç¬¬ä¸€å±¤base85è·Ÿzlibçš„</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="python"><code><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">import</span><span style="--0:#E1E4E8;--1:#24292E"> base64</span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">import</span><span style="--0:#E1E4E8;--1:#24292E"> zlib</span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">import</span><span style="--0:#E1E4E8;--1:#24292E"> marshal</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">encoded </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"c$|e+O>7....Hooz%"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">decoded </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> base64.b85decode(encoded)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">decompressed </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> zlib.decompress(decoded)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">code </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> marshal.loads(decompressed)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972"># print(decompressed) --> åŸºæœ¬ä¸Šé€™å€‹ä¸Ÿåˆ°GPTå°±å¯ä»¥ä¸‰ç§’è§£å®Œäº†</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">dis.dis(code)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import base64import zlibimport marshalencoded = &#x22;c$|e+O>7....Hooz%&#x22;decoded = base64.b85decode(encoded)decompressed = zlib.decompress(decoded)code = marshal.loads(decompressed)# print(decompressed) --> åŸºæœ¬ä¸Šé€™å€‹ä¸Ÿåˆ°GPTå°±å¯ä»¥ä¸‰ç§’è§£å®Œäº†dis.dis(code)"><div></div></button></div></figure></div>
<p>é€™é‚ŠåŸ·è¡Œä¸‹å»æœƒå™´éŒ¯: <code>IndexError: tuple index out of range</code>, å•äº†ä¸€ä¸‹GPTèªªæ˜¯py 3.13åçµ„è­¯èˆŠç‰ˆæœ¬æ™‚å€™çš„æ ¼å¼éŒ¯èª¤ ç”¨<code>3.12</code>å°±å¯äº†</p>
<p>çœ‹äº†ä¸€ä¸‹çµ„è­¯å‡ºçš„æ±è¥¿</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="python"><code><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">16</span><span style="--0:#E1E4E8;--1:#24292E">           </span><span style="--0:#79B8FF;--1:#005CC5">6</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">LOAD_CONST</span><span style="--0:#E1E4E8;--1:#24292E">               </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#F97583;--1:#BF3441">b</span><span style="--0:#9ECBFF;--1:#032F62">'m</span><span style="--0:#79B8FF;--1:#005CC5">\x1b</span><span style="--0:#9ECBFF;--1:#032F62">@I</span><span style="--0:#79B8FF;--1:#005CC5">\x1d</span><span style="--0:#9ECBFF;--1:#032F62">Aoe@</span><span style="--0:#79B8FF;--1:#005CC5">\x07</span><span style="--0:#9ECBFF;--1:#032F62">ZF[BL</span><span style="--0:#79B8FF;--1:#005CC5">\r</span><span style="--0:#9ECBFF;--1:#032F62">N</span><span style="--0:#79B8FF;--1:#005CC5">\n\x0c</span><span style="--0:#9ECBFF;--1:#032F62">S'</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">             </span><span style="--0:#79B8FF;--1:#005CC5">8</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">STORE_FAST</span><span style="--0:#E1E4E8;--1:#24292E">               </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#79B8FF;--1:#005CC5">LEAD_RESEARCHER_SIGNATURE</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">17</span><span style="--0:#E1E4E8;--1:#24292E">          </span><span style="--0:#79B8FF;--1:#005CC5">10</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">LOAD_CONST</span><span style="--0:#E1E4E8;--1:#24292E">               </span><span style="--0:#79B8FF;--1:#005CC5">2</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#F97583;--1:#BF3441">b</span><span style="--0:#9ECBFF;--1:#032F62">'r2b-</span><span style="--0:#79B8FF;--1:#005CC5">\r\x9e\xf2\x1f</span><span style="--0:#9ECBFF;--1:#032F62">p</span><span style="--0:#79B8FF;--1:#005CC5">\x18</span><span style="--0:#9ECBFF;--1:#032F62">5</span><span style="--0:#79B8FF;--1:#005CC5">\x82\xcf\xfc\x90\x14\xf1</span><span style="--0:#9ECBFF;--1:#032F62">O</span><span style="--0:#79B8FF;--1:#005CC5">\xad</span><span style="--0:#9ECBFF;--1:#032F62">#]</span><span style="--0:#79B8FF;--1:#005CC5">\xf3\xe2\xc0</span><span style="--0:#9ECBFF;--1:#032F62">L</span><span style="--0:#79B8FF;--1:#005CC5">\xd0\xc1</span><span style="--0:#9ECBFF;--1:#032F62">e</span><span style="--0:#79B8FF;--1:#005CC5">\x0c\xea\xec\xae\x11</span><span style="--0:#9ECBFF;--1:#032F62">b</span><span style="--0:#79B8FF;--1:#005CC5">\xa7\x8c\xaa</span><span style="--0:#9ECBFF;--1:#032F62">!</span><span style="--0:#79B8FF;--1:#005CC5">\xa1\x9d\xc2\x90</span><span style="--0:#9ECBFF;--1:#032F62">'</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#79B8FF;--1:#005CC5">12</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">STORE_FAST</span><span style="--0:#E1E4E8;--1:#24292E">               </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#79B8FF;--1:#005CC5">ENCRYPTED_CHIMERA_FORMULA</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="16           6 LOAD_CONST               1 (b&#x27;m\x1b@I\x1dAoe@\x07ZF[BL\rN\n\x0cS&#x27;)             8 STORE_FAST               0 (LEAD_RESEARCHER_SIGNATURE)17          10 LOAD_CONST               2 (b&#x27;r2b-\r\x9e\xf2\x1fp\x185\x82\xcf\xfc\x90\x14\xf1O\xad#]\xf3\xe2\xc0L\xd0\xc1e\x0c\xea\xec\xae\x11b\xa7\x8c\xaa!\xa1\x9d\xc2\x90&#x27;)            12 STORE_FAST               1 (ENCRYPTED_CHIMERA_FORMULA)"><div></div></button></div></figure></div>
<p>ä¸Šé¢çš„æ±è¥¿æœƒç”¨ä¾†å‘¼å«<code>usersignerture</code>é€²è¡ŒXORå¾Œé©—è­‰</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="python"><code><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">25</span><span style="--0:#E1E4E8;--1:#24292E">         </span><span style="--0:#79B8FF;--1:#005CC5">126</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">LOAD_GLOBAL</span><span style="--0:#E1E4E8;--1:#24292E">              </span><span style="--0:#79B8FF;--1:#005CC5">9</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">bytes</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">           </span><span style="--0:#79B8FF;--1:#005CC5">136</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">LOAD_CONST</span><span style="--0:#E1E4E8;--1:#24292E">               </span><span style="--0:#79B8FF;--1:#005CC5">5</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#F97583;--1:#BF3441">&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">code </span><span style="--0:#79B8FF;--1:#005CC5">object</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">genexpr</span><span style="--0:#F97583;--1:#BF3441">></span><span style="--0:#E1E4E8;--1:#24292E"> at </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">000002A0BC7A4830</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#FFAB70;--1:#AE4B07">file</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"&#x3C;catalyst_core>"</span><span style="--0:#E1E4E8;--1:#24292E">, line </span><span style="--0:#79B8FF;--1:#005CC5">25</span><span style="--0:#F97583;--1:#BF3441">></span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">           </span><span style="--0:#79B8FF;--1:#005CC5">138</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">MAKE_FUNCTION</span><span style="--0:#E1E4E8;--1:#24292E">            </span><span style="--0:#79B8FF;--1:#005CC5">0</span></div></div><div class="ec-line"><div class="code"><span class="indent">           </span><span style="--0:#79B8FF;--1:#005CC5">140</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">LOAD_GLOBAL</span><span style="--0:#E1E4E8;--1:#24292E">             </span><span style="--0:#79B8FF;--1:#005CC5">11</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">enumerate</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">           </span><span style="--0:#79B8FF;--1:#005CC5">150</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">LOAD_FAST</span><span style="--0:#E1E4E8;--1:#24292E">                </span><span style="--0:#79B8FF;--1:#005CC5">2</span><span style="--0:#E1E4E8;--1:#24292E"> (current_user)</span></div></div><div class="ec-line"><div class="code"><span class="indent">           </span><span style="--0:#79B8FF;--1:#005CC5">152</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">CALL</span><span style="--0:#E1E4E8;--1:#24292E">                     </span><span style="--0:#79B8FF;--1:#005CC5">1</span></div></div><div class="ec-line"><div class="code"><span class="indent">           </span><span style="--0:#79B8FF;--1:#005CC5">160</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">GET_ITER</span></div></div><div class="ec-line"><div class="code"><span class="indent">           </span><span style="--0:#79B8FF;--1:#005CC5">162</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">CALL</span><span style="--0:#E1E4E8;--1:#24292E">                     </span><span style="--0:#79B8FF;--1:#005CC5">0</span></div></div><div class="ec-line"><div class="code"><span class="indent">           </span><span style="--0:#79B8FF;--1:#005CC5">170</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">CALL</span><span style="--0:#E1E4E8;--1:#24292E">                     </span><span style="--0:#79B8FF;--1:#005CC5">1</span></div></div><div class="ec-line"><div class="code"><span class="indent">           </span><span style="--0:#79B8FF;--1:#005CC5">178</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">STORE_FAST</span><span style="--0:#E1E4E8;--1:#24292E">               </span><span style="--0:#79B8FF;--1:#005CC5">3</span><span style="--0:#E1E4E8;--1:#24292E"> (user_signature)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="25         126 LOAD_GLOBAL              9 (NULL + bytes)           136 LOAD_CONST               5 (<code object <genexpr> at 0x000002A0BC7A4830, file &#x22;<catalyst_core>&#x22;, line 25>)           138 MAKE_FUNCTION            0           140 LOAD_GLOBAL             11 (NULL + enumerate)           150 LOAD_FAST                2 (current_user)           152 CALL                     1           160 GET_ITER           162 CALL                     0           170 CALL                     1           178 STORE_FAST               3 (user_signature)"><div></div></button></div></figure></div>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="python"><code><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">20</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">LOAD_FAST</span><span style="--0:#E1E4E8;--1:#24292E">                </span><span style="--0:#79B8FF;--1:#005CC5">2</span><span style="--0:#E1E4E8;--1:#24292E"> (c)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">22</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">LOAD_FAST</span><span style="--0:#E1E4E8;--1:#24292E">                </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E"> (i)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">24</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">LOAD_CONST</span><span style="--0:#E1E4E8;--1:#24292E">               </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#79B8FF;--1:#005CC5">42</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">26</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">BINARY_OP</span><span style="--0:#E1E4E8;--1:#24292E">                </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">30</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">BINARY_OP</span><span style="--0:#E1E4E8;--1:#24292E">               </span><span style="--0:#79B8FF;--1:#005CC5">12</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#F97583;--1:#BF3441">^</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="20 LOAD_FAST                2 (c)22 LOAD_FAST                1 (i)24 LOAD_CONST               0 (42)26 BINARY_OP                0 (+)30 BINARY_OP               12 (^)"><div></div></button></div></figure></div>
<p>å°æ‡‰python<code>user_signature = bytes(c ^ (i + 42) for i, c in enumerate(current_user))</code></p>
<p>æœ€å¾Œå° <code>current_user</code> é€²è¡ŒARC4åŠ å¯†</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="python"><code><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">37</span><span style="--0:#E1E4E8;--1:#24292E">         </span><span style="--0:#79B8FF;--1:#005CC5">354</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">LOAD_GLOBAL</span><span style="--0:#E1E4E8;--1:#24292E">             </span><span style="--0:#79B8FF;--1:#005CC5">21</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#79B8FF;--1:#005CC5">NULL</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">ARC4</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">           </span><span style="--0:#79B8FF;--1:#005CC5">364</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">LOAD_FAST</span><span style="--0:#E1E4E8;--1:#24292E">                </span><span style="--0:#79B8FF;--1:#005CC5">2</span><span style="--0:#E1E4E8;--1:#24292E"> (current_user)</span></div></div><div class="ec-line"><div class="code"><span class="indent">           </span><span style="--0:#79B8FF;--1:#005CC5">366</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">CALL</span><span style="--0:#E1E4E8;--1:#24292E">                     </span><span style="--0:#79B8FF;--1:#005CC5">1</span></div></div><div class="ec-line"><div class="code"><span class="indent">           </span><span style="--0:#79B8FF;--1:#005CC5">374</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">STORE_FAST</span><span style="--0:#E1E4E8;--1:#24292E">               </span><span style="--0:#79B8FF;--1:#005CC5">5</span><span style="--0:#E1E4E8;--1:#24292E"> (arc4_decipher)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="37         354 LOAD_GLOBAL             21 (NULL + ARC4)           364 LOAD_FAST                2 (current_user)           366 CALL                     1           374 STORE_FAST               5 (arc4_decipher)"><div></div></button></div></figure></div>
<p>sol:
<code>user --XOR--> signature</code> æ‰€ä»¥ <code>signature --XOR--> user </code></p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="python"><code><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">from</span><span style="--0:#E1E4E8;--1:#24292E"> arc4 </span><span style="--0:#F97583;--1:#BF3441">import</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">ARC4</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">LEAD_RESEARCHER_SIGNATURE</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">b</span><span style="--0:#9ECBFF;--1:#032F62">"m</span><span style="--0:#79B8FF;--1:#005CC5">\x1b</span><span style="--0:#9ECBFF;--1:#032F62">@I</span><span style="--0:#79B8FF;--1:#005CC5">\x1d</span><span style="--0:#9ECBFF;--1:#032F62">Aoe@</span><span style="--0:#79B8FF;--1:#005CC5">\x07</span><span style="--0:#9ECBFF;--1:#032F62">ZF[BL</span><span style="--0:#79B8FF;--1:#005CC5">\r</span><span style="--0:#9ECBFF;--1:#032F62">N</span><span style="--0:#79B8FF;--1:#005CC5">\n\x0c</span><span style="--0:#9ECBFF;--1:#032F62">S"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">ENCRYPTED_CHIMERA_FORMULA</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">b</span><span style="--0:#9ECBFF;--1:#032F62">"r2b-</span><span style="--0:#79B8FF;--1:#005CC5">\r\x9e\xf2\x1f</span><span style="--0:#9ECBFF;--1:#032F62">p</span><span style="--0:#79B8FF;--1:#005CC5">\x18</span><span style="--0:#9ECBFF;--1:#032F62">5</span><span style="--0:#79B8FF;--1:#005CC5">\x82\xcf\xfc\x90\x14\xf1</span><span style="--0:#9ECBFF;--1:#032F62">O</span><span style="--0:#79B8FF;--1:#005CC5">\xad</span><span style="--0:#9ECBFF;--1:#032F62">#]</span><span style="--0:#79B8FF;--1:#005CC5">\xf3\xe2\xc0</span><span style="--0:#9ECBFF;--1:#032F62">L</span><span style="--0:#79B8FF;--1:#005CC5">\xd0\xc1</span><span style="--0:#9ECBFF;--1:#032F62">e</span><span style="--0:#79B8FF;--1:#005CC5">\x0c\xea\xec\xae\x11</span><span style="--0:#9ECBFF;--1:#032F62">b</span><span style="--0:#79B8FF;--1:#005CC5">\xa7\x8c\xaa</span><span style="--0:#9ECBFF;--1:#032F62">!</span><span style="--0:#79B8FF;--1:#005CC5">\xa1\x9d\xc2\x90</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">## XOR current user</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">username </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">bytes</span><span style="--0:#E1E4E8;--1:#24292E">(c </span><span style="--0:#F97583;--1:#BF3441">^</span><span style="--0:#E1E4E8;--1:#24292E"> (i </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">42</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">for</span><span style="--0:#E1E4E8;--1:#24292E"> i, c </span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">enumerate</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">LEAD_RESEARCHER_SIGNATURE</span><span style="--0:#E1E4E8;--1:#24292E">))</span></div></div><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">print</span><span style="--0:#E1E4E8;--1:#24292E">(username)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">print</span><span style="--0:#E1E4E8;--1:#24292E">(ARC4(username).decrypt(</span><span style="--0:#79B8FF;--1:#005CC5">ENCRYPTED_CHIMERA_FORMULA</span><span style="--0:#E1E4E8;--1:#24292E">))</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="from arc4 import ARC4LEAD_RESEARCHER_SIGNATURE = b&#x22;m\x1b@I\x1dAoe@\x07ZF[BL\rN\n\x0cS&#x22;ENCRYPTED_CHIMERA_FORMULA = b&#x22;r2b-\r\x9e\xf2\x1fp\x185\x82\xcf\xfc\x90\x14\xf1O\xad#]\xf3\xe2\xc0L\xd0\xc1e\x0c\xea\xec\xae\x11b\xa7\x8c\xaa!\xa1\x9d\xc2\x90&#x22;## XOR current userusername = bytes(c ^ (i + 42) for i, c in enumerate(LEAD_RESEARCHER_SIGNATURE))print(username)print(ARC4(username).decrypt(ENCRYPTED_CHIMERA_FORMULA))"><div></div></button></div></figure></div>
</div>
</details>
<details data-callout="" data-callout-type="note" open>
<summary data-callout-title="">å»¶ä¼¸</summary>
<div data-callout-body="">
<p>åœ¨å¯«WPçš„æ™‚å€™å¤šçœ‹äº†ä¸€ä¸‹pythonçš„opcodeçµæ§‹(å°±æ˜¯marshalå‡ºä¾†çš„pycæª”æ¡ˆ)
åƒè€ƒäº†é€™ç¯‡æ–‡ç« : <a href="https://www.buaq.net/go-9664.html">åˆ©ç”¨OpCodeç»•è¿‡Pythonæ²™ç®± - å…ˆçŸ¥ç¤¾åŒº</a></p>
<p>å¯ä»¥ç”¨<code>dis.dis()</code>ä¾†è§£æ§‹pyc
ä»¥é€™é¡Œç‚ºä¾‹ï¼Œç”¨<code>dis.dis(marshal.loads(b"..."))</code>æœƒæ‹¿åˆ°</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e"> </span></span><span style="--0:#e1e4e8;--1:#24292e">0           BINARY_OP                0 (+)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e">             </span></span><span style="--0:#e1e4e8;--1:#24292e">POP_JUMP_IF_TRUE         1 (to L1)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e">             </span></span><span style="--0:#e1e4e8;--1:#24292e">LOAD_FROM_DICT_OR_GLOBALS 0 (base64)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e"> </span></span><span style="--0:#e1e4e8;--1:#24292e">3   L1:     POP_JUMP_IF_TRUE         0 (to L2)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e">     </span></span><span style="--0:#e1e4e8;--1:#24292e">L2:     STORE_ATTR               1 (zlib)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e">             </span></span><span style="--0:#e1e4e8;--1:#24292e">LOAD_FROM_DICT_OR_GLOBALS 2 (marshal)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e"> </span></span><span style="--0:#e1e4e8;--1:#24292e">5           POP_JUMP_IF_TRUE         0 (to L3)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e">     </span></span><span style="--0:#e1e4e8;--1:#24292e">L3:     STORE_ATTR               3 (types)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e">             </span></span><span style="--0:#e1e4e8;--1:#24292e">RAISE_VARARGS            5</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e">             </span></span><span style="--0:#e1e4e8;--1:#24292e">POP_JUMP_IF_TRUE         3 (to L4)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">...</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code=" 0           BINARY_OP                0 (+)             POP_JUMP_IF_TRUE         1 (to L1)             LOAD_FROM_DICT_OR_GLOBALS 0 (base64) 3   L1:     POP_JUMP_IF_TRUE         0 (to L2)     L2:     STORE_ATTR               1 (zlib)             LOAD_FROM_DICT_OR_GLOBALS 2 (marshal) 5           POP_JUMP_IF_TRUE         0 (to L3)     L3:     STORE_ATTR               3 (types)             RAISE_VARARGS            5             POP_JUMP_IF_TRUE         3 (to L4)..."><div></div></button></div></figure></div>
<p>ç„¶å¾Œå¯ä»¥å»åšé€²ä¸€æ­¥çš„åˆ†æ</p>
</div>
</details>
<h3 id="03">03</h3>
<p>pdf misc</p>
<details data-callout="" data-callout-type="quote" open>
<summary data-callout-title="">challenge</summary>
<div data-callout-body="">
<p>æ‹¿åˆ°ä¸€å€‹pdf å»çœ‹äº†ä¸€ä¸‹string</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">%PDF-2.0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">%SNDHNRO0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">RE~^</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">% Hey there! Welcome to this source...</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">% Tested under the following browsers:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">% Chrome, Safari, PDFjs (Firefox)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">1       0       obj     &#x3C;&#x3C;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">% N0t_a_flag_but_just_a_line_comment</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">/Pages  2       0       R/Type/Catalog/Extensions       &#x3C;&#x3C;/ADBE &#x3C;&#x3C;/BaseVersion/1.7/ExtensionLevel       8>>>>>>endobj</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">% 2 0 obj</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">% &#x3C;&#x3C;>></span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">% endobj</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">3 0 obj</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e"> </span></span><span style="--0:#e1e4e8;--1:#24292e">/Contents 4 0 R</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e"> </span></span><span style="--0:#e1e4e8;--1:#24292e">/Parent 2 0 R</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e"> </span></span><span style="--0:#e1e4e8;--1:#24292e">/Resources 6 0 R</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e"> </span></span><span style="--0:#e1e4e8;--1:#24292e">/Type /Page</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e"> </span></span><span style="--0:#e1e4e8;--1:#24292e">/MediaBox [0 0 612 130]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">endobj</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">2 0 obj</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e"> </span></span><span style="--0:#e1e4e8;--1:#24292e">/Count 1</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e"> </span></span><span style="--0:#e1e4e8;--1:#24292e">/Kids [</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e">   </span></span><span style="--0:#e1e4e8;--1:#24292e">3 0 R</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e"> </span></span><span style="--0:#e1e4e8;--1:#24292e">/Type /Pages</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">endobj</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">% 2 0 obj</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">% &#x3C;&#x3C;>></span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">% endobj</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">4 0 obj</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">&#x3C;&#x3C;/Length 320/Filter /FlateDecode>>stream</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">...</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="%PDF-2.0%SNDHNRO0RE~^% Hey there! Welcome to this source...% Tested under the following browsers:% Chrome, Safari, PDFjs (Firefox)1       0       obj     <<% N0t_a_flag_but_just_a_line_comment/Pages  2       0       R/Type/Catalog/Extensions       <</ADBE <</BaseVersion/1.7/ExtensionLevel       8>>>>>>endobj% 2 0 obj% <<>>% endobj3 0 obj /Contents 4 0 R /Parent 2 0 R /Resources 6 0 R /Type /Page /MediaBox [0 0 612 130]endobj2 0 obj /Count 1 /Kids [   3 0 R /Type /Pagesendobj% 2 0 obj% <<>>% endobj4 0 obj<</Length 320/Filter /FlateDecode>>stream..."><div></div></button></div></figure></div>
<p><code>/Pages  2 0 R</code> é€™äº›åœ°æ–¹çœ‹èµ·ä¾†åƒæ˜¯pdf pages çš„å£“ç¸®</p>
</div>
</details>
<details data-callout="" data-callout-type="note" open>
<summary data-callout-title="">notes</summary>
<div data-callout-body="">
<p>é‚è¼¯æ˜¯</p>
<ol>
<li>
<p>å…ˆè§£pdfå£“ç¸®çš„æ±è¥¿</p>
</li>
<li>
<p>ç„¶å¾Œçœ‹strings çœ‹åˆ°ä¸€ä¸²ffd8ffe00â€¦ è½‰æ›æˆjpeg</p>
</li>
<li>
<p>ç„¶å¾Œç™¼ç¾å¥½åƒå“ªè£¡ä¸å° æ˜¯ä¸€å¨æ±è¥¿è€Œä¸”exiftoolèªªä»–æ˜¯<code>1*37</code>çš„åœ–ç‰‡</p>
</li>
<li>
<p>å°±æŠŠç›¸ç´ æå–å‡ºä¾†æ›æˆASCII</p>
</li>
</ol>
<div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#B392F0;--1:#6F42C1">â”Œâ”€â”€(kaliã‰¿kali</span><span style="--0:#E1E4E8;--1:#24292E">)-[/media/sf_SHARED_FILE/flareon/03]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#B392F0;--1:#6F42C1">â””â”€$</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">qpdf</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">--qdf</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">--object-streams=disable</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">pretty_devilish_file.pdf</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">step1.pdf</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="â”Œâ”€â”€(kaliã‰¿kali)-[/media/sf_SHARED_FILE/flareon/03]â””â”€$ qpdf --qdf --object-streams=disable pretty_devilish_file.pdf step1.pdf"><div></div></button></div></figure></div>
<p>å†æ¬¡strings</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">%PDF-2.0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">%QDF-1.0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">%% Original object ID: 1 0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">1 0 obj</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">&#x3C;SNIP></span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">2 0 obj</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">&#x3C;SNIP></span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">3 0 obj</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">&#x3C;SNIP></span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">4 0 obj</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">&#x3C;SINP></span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">ffd8ffe000104a46494600010100000100010000ffdb00430001010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101ffc0000b080001002501011100ffc40017000100030000000000000000000000000006040708ffc400241000000209050100000000000000000000000702050608353776b6b7030436747577ffda0008010100003f00c54d3401dcbbfb9c38db8a7dd265a2159e9d945a086407383aabd52e5034c274e57179ef3bcdfca50f0af80aff00e986c64568c7ffd9</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">&#x3C;SNIP></span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">(Flare-On!)'</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">endstream</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">&#x3C;SNIP></span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">%%EOF</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="%PDF-2.0%QDF-1.0%% Original object ID: 1 01 0 obj<SNIP>2 0 obj<SNIP>3 0 obj<SNIP>4 0 obj<SINP>ffd8ffe000104a46494600010100000100010000ffdb00430001010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101ffc0000b080001002501011100ffc40017000100030000000000000000000000000006040708ffc400241000000209050100000000000000000000000702050608353776b6b7030436747577ffda0008010100003f00c54d3401dcbbfb9c38db8a7dd265a2159e9d945a086407383aabd52e5034c274e57179ef3bcdfca50f0af80aff00e986c64568c7ffd9<SNIP>(Flare-On!)&#x27;endstream<SNIP>%%EOF"><div></div></button></div></figure></div>
<p>åœ¨ç¬¬å››å€‹åœ°æ–¹çœ‹åˆ°äº†ffd8â€¦ffd9 ä¸€çœ‹å°±æ˜¯JPEG
å¾Œé¢ç”¨exiftool è§€å¯Ÿ</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">Encoding Process                : Baseline DCT, Huffman coding</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">Image Size                      : 37x1</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="Encoding Process                : Baseline DCT, Huffman codingImage Size                      : 37x1"><div></div></button></div></figure></div>
<p>çœ‹ä¸€ä¸‹pixelsè£¡é¢çš„æ±è¥¿ æ„Ÿè¦ºå¾ˆascii æ–¼æ˜¯å°±é€šéˆå‡ºä¾†äº†(</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="python"><code><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">from</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">PIL</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">import</span><span style="--0:#E1E4E8;--1:#24292E"> Image</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">img </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> Image.open(</span><span style="--0:#9ECBFF;--1:#032F62">'extracted.jpg'</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">pixels </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">list</span><span style="--0:#E1E4E8;--1:#24292E">(img.getdata())</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">### print(pixels)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972">## [80, 117, 122, 122, 108, 49, 110, 103, 45, 68, 51, 118, 105, 108, 105, 115, 104, 45, 70, 48, 114, 109, 97, 116, 64, 102, 108, 97, 114, 101, 45, 111, 110, 46, 99, 111, 109]</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">ascii_str </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">''</span><span style="--0:#E1E4E8;--1:#24292E">.join(</span><span style="--0:#79B8FF;--1:#005CC5">chr</span><span style="--0:#E1E4E8;--1:#24292E">(p) </span><span style="--0:#F97583;--1:#BF3441">for</span><span style="--0:#E1E4E8;--1:#24292E"> p </span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#E1E4E8;--1:#24292E"> pixels)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">print</span><span style="--0:#E1E4E8;--1:#24292E">(ascii_str)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="from PIL import Imageimg = Image.open(&#x27;extracted.jpg&#x27;)pixels = list(img.getdata())### print(pixels)## [80, 117, 122, 122, 108, 49, 110, 103, 45, 68, 51, 118, 105, 108, 105, 115, 104, 45, 70, 48, 114, 109, 97, 116, 64, 102, 108, 97, 114, 101, 45, 111, 110, 46, 99, 111, 109]ascii_str = &#x27;&#x27;.join(chr(p) for p in pixels)print(ascii_str)"><div></div></button></div></figure></div>
</div>
</details>
<p>åˆæ˜¯å±¬æ–¼é€šéˆä»”çš„å‹åˆ©(
åˆ°é€™é‚Šå·®ä¸å¤šéäº†30åˆ†é˜ ç„¶å¾Œå¾Œé¢é–‹å§‹ä¸€ç›´é€šéˆå¤±æ•—QQ</p>
<h3 id="04">04</h3>
<p>é€™é¡Œå…¶å¯¦å¾ˆæ°´(
å…¶å¯¦å¥½åƒäº”åˆ†é˜å°±åšå®Œäº†ä½†æ˜¯ä¸€ç›´å·®æœ€å¾Œä¸€éƒ¨æ‰€ä»¥è·‘å»é€†å‘twinbasicçš„æ±è¥¿èŠ±äº†ä¸€å¤©ğŸ¤¡</p>
<details data-callout="" data-callout-type="quote" open>
<summary data-callout-title="">challenge</summary>
<div data-callout-body="">
<p></p>
<h4 id="ä¿®å¾©æª”æ¡ˆ">ä¿®å¾©æª”æ¡ˆ</h4>
<p>xxd å…ˆçœ‹ä¸‹ç™¼ç¾ä»–æ˜¯ é–‹é ­æ˜¯<code>15 5A</code>çš„EXE æ‰€ä»¥è¦æ”¹æˆæ¨™æº–çš„header <code>4d 5a</code>
<code>printf '\x4D' | dd of=UnholyDragon-150.exe bs=1 seek=0 count=1 conv=notrunc</code>
é€™æ¨£å°±æ­£å¸¸äº†</p>
<h4 id="èª¿æŸ¥çµæ§‹é€™é‚Šå¯ä»¥è·³é-ç´”ç´”å°ä¸‘éç¨‹">èª¿æŸ¥çµæ§‹(é€™é‚Šå¯ä»¥è·³é ç´”ç´”å°ä¸‘éç¨‹)</h4>
<p>ç„¶å¾Œé–‹DIEçœ‹åˆ°
<code>(Heur)Packer: Compressed or packed data[High entropy + Section 1 (".data") compressed]</code>
ç„¶å¾Œå› ç‚ºåŸ·è¡Œä¸‹å»æœƒå‡ºç¾151.exe ~ 154.exe æ‰€ä»¥æ‡·ç–‘äº†ä¸€ä¸‹æ˜¯å¤šå±¤åµŒå¥—çš„exe</p>
<p>ç”¨é€™é‚Šä¾†çœ‹MZæˆ–æ˜¯PE çš„æª”æ¡ˆçµæ§‹
MZé–‹é ­æ˜¯4D5A -> <code>grep -aobP $'\x4d\x5a' UnholyDragon-150.exe</code>
PEé–‹é ­æ˜¯450045 -> <code>grep -aobP $'\x50\x45\x00\x00' UnholyDragon-150.exe</code></p>
<p>çœ‹åˆ°äº†å¾ˆå¤šæ„Ÿè¦ºæ˜¯å£“ç¸®é€²å»çš„æ±è¥¿
å¾Œé¢ç›´æ¥å»é€†å‘è§€å¯Ÿç™¼ç¾ä»–æ˜¯ä¸€å€‹twinBasicçš„æ±è¥¿(æå–çš„ICONä¹Ÿé•·ä¸€æ¨£)</p>
<p>(( ä½†å¥½åƒé€™æ¨£å°±å¯ä»¥çœ‹åˆ°äº† çœŸçš„æ˜¯å°ä¸‘:(</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="xml"><code><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">â”Œâ”€â”€(kaliã‰¿kali)-[/media/sf_SHARED_FILE/flareon/04/origional]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">â””â”€$ tail -c 2000 ../UnholyDragon-150.exe | strings</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">&#x3C;?</span><span style="--0:#85E89D;--1:#1E7734">xml</span><span style="--0:#B392F0;--1:#6F42C1"> version</span><span style="--0:#E1E4E8;--1:#24292E">=</span><span style="--0:#9ECBFF;--1:#032F62">"1.0"</span><span style="--0:#B392F0;--1:#6F42C1"> encoding</span><span style="--0:#E1E4E8;--1:#24292E">=</span><span style="--0:#9ECBFF;--1:#032F62">"UTF-8"</span><span style="--0:#B392F0;--1:#6F42C1"> standalone</span><span style="--0:#E1E4E8;--1:#24292E">=</span><span style="--0:#9ECBFF;--1:#032F62">"yes"</span><span style="--0:#E1E4E8;--1:#24292E">?></span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">&#x3C;</span><span style="--0:#85E89D;--1:#1E7734">assembly</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">xmlns</span><span style="--0:#E1E4E8;--1:#24292E">=</span><span style="--0:#9ECBFF;--1:#032F62">"urn:schemas-microsoft-com:asm.v1"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">manifestVersion</span><span style="--0:#E1E4E8;--1:#24292E">=</span><span style="--0:#9ECBFF;--1:#032F62">"1.0"</span><span style="--0:#E1E4E8;--1:#24292E">></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">&#x3C;</span><span style="--0:#85E89D;--1:#1E7734">assemblyIdentity</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#B392F0;--1:#6F42C1">type</span><span style="--0:#E1E4E8;--1:#24292E">=</span><span style="--0:#9ECBFF;--1:#032F62">"win32"</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#B392F0;--1:#6F42C1">processorArchitecture</span><span style="--0:#E1E4E8;--1:#24292E">=</span><span style="--0:#9ECBFF;--1:#032F62">"*"</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#B392F0;--1:#6F42C1">name</span><span style="--0:#E1E4E8;--1:#24292E">=</span><span style="--0:#9ECBFF;--1:#032F62">"My_twinBASIC_Application"</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#B392F0;--1:#6F42C1">version</span><span style="--0:#E1E4E8;--1:#24292E">=</span><span style="--0:#9ECBFF;--1:#032F62">"1.0.0.0"</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">/></span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">&#x3C;/</span><span style="--0:#85E89D;--1:#1E7734">assembly</span><span style="--0:#E1E4E8;--1:#24292E">></span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="â”Œâ”€â”€(kaliã‰¿kali)-[/media/sf_SHARED_FILE/flareon/04/origional]â””â”€$ tail -c 2000 ../UnholyDragon-150.exe | strings<?xml version=&#x22;1.0&#x22; encoding=&#x22;UTF-8&#x22; standalone=&#x22;yes&#x22;?><assembly xmlns=&#x22;urn:schemas-microsoft-com:asm.v1&#x22; manifestVersion=&#x22;1.0&#x22;>  <assemblyIdentity     type=&#x22;win32&#x22;     processorArchitecture=&#x22;*&#x22;     name=&#x22;My_twinBASIC_Application&#x22;     version=&#x22;1.0.0.0&#x22;  /></assembly>"><div></div></button></div></figure></div>
<p>è£¡é¢é€†é€²å»æ˜¯ä¸€äº›è‡ªè§£å£“çš„é‚è¼¯å’Œç¶“éæ··æ·†çš„å¾ˆå¤šfunc
(ä¸‹ç•¥Nå°æ™‚çš„é€†å‘æ™‚é–“)</p>
</div>
</details>
<details data-callout="" data-callout-type="note" open>
<summary data-callout-title="">solution</summary>
<div data-callout-body="">
<p><strong>TL;DR autongæç¤ºèªªç©ä¸€ç©å°±æœ‰flagäº†</strong>
æƒ³èªªåœ¨å”¬çˆ›å§ ç„¶å¾Œä»–å«æˆ‘çœ‹çœ‹æª”æ¡ˆåç¨±</p>
<p>çµ‚æ–¼å‹•å¿µå»æŠŠ<code>UnholyDragon-150.exe</code>-><code>UnholyDragon.exe</code>
å°±è·‘å‡ºäº†1-154 å·®é»æŠŠè™›æ“¬æ©Ÿææ²’
å…¶ä¸­126-148éƒ½æœ‰åœ¨åŸ·è¡Œ
ä½†æ˜¯150ä¸€æ¨£é–‹é ­å£æ‰
(åˆ°é€™é‚Šæˆ‘é‚„æƒ³èªªé‚„æ˜¯æ‡‰è©²å†é€†ä¸€ä¸‹å—) (ä¸‹ç•¥Nå°æ™‚é€†å‘å¦™å¦™å±‹)</p>
<p>ä½†å…¶å¯¦ä¸€æ¨£ä¿®ä¸€ä¸‹é–‹é ­é‡æ–°åŸ·è¡Œå°±æœ‰äº†flagäº†
ä½†æ˜¯ä¸­é–“å­¸åˆ°äº†ä¸€äº›è§£å£“ç¸®çš„æ–¹æ³•è·Ÿtwinbasicèªæ³• è »å¥½ç©çš„ è€¶</p>
</div>
</details>
<h3 id="05">05</h3>
<details data-callout="" data-callout-type="quote" open>
<summary data-callout-title="">challenge</summary>
<div data-callout-body="">
<p></p>
<blockquote>
<p>Iâ€™m not here to tell you how to do your job or anything, given that you are a top notch computer scientist who has solved four challenges already, but NTFS is in the filename. Maybe, I donâ€™t know, run it in windows on an NTFS file system?</p>
</blockquote>
<p>strings çœ‹åˆ°ä¸€äº›æœ‰è¶£çš„æ±è¥¿</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">D:\a\_work\1\s\binaries\amd64ret\inc\optional</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">D:\a\_work\1\s\src\vctools\crt\vcruntime\src\eh\std_type_info.cpp</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">D:\a\_work\1\s\src\vctools\crt\vcruntime\src\internal\per_thread_data.cpp</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">minkernel\crts\ucrt\src\appcrt\misc\dbgrpt.cpp</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">minkernel\crts\ucrt\src\appcrt\stdio\_file.cpp</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">https://www.youtube.com/watch?v=dQw4w9WgXcQ&#x26;list=RDdQw4w9WgXcQ</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">C:\\Users\\flare\\Desktop\\challenge\\main.pdb</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="D:\a\_work\1\s\binaries\amd64ret\inc\optionalD:\a\_work\1\s\src\vctools\crt\vcruntime\src\eh\std_type_info.cppD:\a\_work\1\s\src\vctools\crt\vcruntime\src\internal\per_thread_data.cppminkernel\crts\ucrt\src\appcrt\misc\dbgrpt.cppminkernel\crts\ucrt\src\appcrt\stdio\_file.cpphttps://www.youtube.com/watch?v=dQw4w9WgXcQ&#x26;list=RDdQw4w9WgXcQC:\\Users\\flare\\Desktop\\challenge\\main.pdb"><div></div></button></div></figure></div>
<p>åˆæ˜¯ç‘å…‹æ– ==
ä½†æœ€å¾Œé‚£å€‹æ„Ÿè¦ºæ˜¯è¦ä¿®pdb
ç„¶å¾Œé¡Œç›®æç¤ºæ˜¯è·Ÿntfsç›¸é—œçš„æ±è¥¿</p>
<h4 id="ntfs-stream">NTFS stream</h4>
<p>ç„¶å¾Œå¦å¤–å»æ‰¾äº†ä¸€ä¸‹ntfsç›¸é—œçš„èƒŒæ™¯çŸ¥è­˜é‚„æœ‰ä¹‹å‰AIS3é¦¬å¸«è¬›åˆ°çš„å†streamè£¡é¢è—æ±è¥¿çš„evadeæ–¹æ³•ç­†è¨˜</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">Get-Item -Path .\ntfsm.exe -Stream *                                               15:59:45</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">PSPath        : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05\ntfsm.exe::$DATA</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">PSParentPath  : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">PSChildName   : ntfsm.exe::$DATA</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">FileName      : C:\flareon\05\ntfsm.exe</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">Stream        : :$DATA</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">Length        : 20151296</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">PSPath        : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05\ntfsm.exe:input</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">PSParentPath  : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">PSChildName   : ntfsm.exe:input</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">Stream        : input</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">Length        : 16</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">PSPath        : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05\ntfsm.exe:positi</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e">               </span></span><span style="--0:#e1e4e8;--1:#24292e">on</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">PSParentPath  : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">PSChildName   : ntfsm.exe:position</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">Stream        : position</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">Length        : 8</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">PSPath        : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05\ntfsm.exe:state</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">PSParentPath  : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">PSChildName   : ntfsm.exe:state</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">Stream        : state</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">Length        : 8</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">PSPath        : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05\ntfsm.exe:transi</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#e1e4e8;--1:#24292e">               </span></span><span style="--0:#e1e4e8;--1:#24292e">tions</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">PSParentPath  : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">PSChildName   : ntfsm.exe:transitions</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">Stream        : transitions</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">Length        : 8</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="Get-Item -Path .\ntfsm.exe -Stream *                                               15:59:45PSPath        : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05\ntfsm.exe::$DATAPSParentPath  : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05PSChildName   : ntfsm.exe::$DATAFileName      : C:\flareon\05\ntfsm.exeStream        : :$DATALength        : 20151296PSPath        : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05\ntfsm.exe:inputPSParentPath  : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05PSChildName   : ntfsm.exe:inputStream        : inputLength        : 16PSPath        : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05\ntfsm.exe:positi               onPSParentPath  : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05PSChildName   : ntfsm.exe:positionStream        : positionLength        : 8PSPath        : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05\ntfsm.exe:statePSParentPath  : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05PSChildName   : ntfsm.exe:stateStream        : stateLength        : 8PSPath        : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05\ntfsm.exe:transi               tionsPSParentPath  : Microsoft.PowerShell.Core\FileSystem::C:\flareon\05PSChildName   : ntfsm.exe:transitionsStream        : transitionsLength        : 8"><div></div></button></div></figure></div>
<p>è·Ÿå‰é¢éœæ…‹é€†å‡ºä¾†çš„å¹¾å€‹é—œéµåƒæ•¸æœ‰å°ä¸Š</p>
</div>
</details>
<details data-callout="" data-callout-type="note" open>
<summary data-callout-title="">solution</summary>
<div data-callout-body="">
<p></p>
<h3 id="éœæ…‹åˆ†æä¸»è¦å‡½æ•¸">éœæ…‹åˆ†æä¸»è¦å‡½æ•¸</h3>
<p>çœ‹åˆ°stringè£¡é¢æœ‰å€‹<code>input 16 characters</code>çš„æª¢æŸ¥ï¼Œé †è—¤æ‘¸ç“œæ‰¾åˆ°ä¸»è¦çš„æ¯”è¼ƒå‡½å¼</p>
<ul>
<li><code>sub_14000c0b0</code>: è£¡é¢ä¾åºè¨­å®šäº†4å€‹map: <code>state, input, position, transitions</code></li>
<li>é€å­—å…ƒè®€å–ä¸¦è¨­å®š<code>state</code></li>
<li>åƒè€ƒ<code>jump table</code> (0x000140ca3b) è®€å–å‡ºè¦æ¯”è¼ƒçš„ç›®æ¨™
<ul>
<li><strong>ä¸­é–“å¡åœ¨é€™é‚Šä¸çŸ¥é“æ€éº¼å»å®šä½åˆ°å…·é«”çš„æ¯”è¼ƒç›®æ¨™ä»¥åŠé¸é …ä¹‹é–“çš„æ¨¹ç‹€é—œä¿‚</strong></li>
</ul>
</li>
<li>tableæœƒæ ¹æ“šstateé€²å…¥ä¸åŒçš„åˆ†æ”¯ç„¶å¾Œé€²è¡Œå°æ‡‰çš„å­—å…ƒæ¯”è¼ƒä¸¦å¯«å…¥æ–°çš„state</li>
<li>æŠŠstateå¯«å…¥ NTFS ADS (sub_140FF1190)</li>
<li>åŸ·è¡Œshellcode è·‘ create subprocess
<ul>
<li>æ²’æå¥½æœƒç™»å‡ºé›»è…¦é‡é–‹æ©ŸQQ</li>
</ul>
</li>
<li>å¦‚æœä¸€é€£ä¸²éƒ½æ˜¯å°çš„æœƒå»è·‘flagçš„func<code>sub_14000b2a0</code>(ä½†æ˜¯é¦–å…ˆé‚„æ˜¯éœ€è¦çŸ¥é“é‚£å€‹16bits</li>
</ul>
<div class="mermaid">
  flowchart TD
   A[ç”¨æˆ¶åŸ·è¡Œç¨‹å¼] --> B[è®€å– NTFS ADS]
   B --> C{ç¬¬ä¸€æ¬¡åŸ·è¡Œï¼Ÿ}
   C -->|æ˜¯| D[åˆå§‹åŒ–]
   D --> E[exit]

   C -->|å¦| F{position &#x3C; 16ï¼Ÿ}
   
   F -->|Yes| G[ç¹¼çºŒè™•ç†]
   G --> H[è·³è½‰è¡¨æŸ¥æ‰¾]
   H --> I[state â†’ æŸ¥è¡¨ â†’ ä»£ç¢¼åœ°å€]
   I --> J[è·³è½‰åˆ°è©²åœ°å€]
   J --> K[åŸ·è¡Œç‹€æ…‹è™•ç†ä»£ç¢¼]
   K --> L{å­—å…ƒåŒ¹é…ï¼Ÿ}

   L -->|Yes| M[æ–°ç‹€æ…‹ï¼Œtransitions++]
   L -->|No| N[ShellExecuteA â†’ é€²ç¨‹çˆ†ç‚¸]

   M --> O[position++]
   O --> P[æ›´æ–° ADS]
   P --> Q[exit 0]

   F -->|No| R[æª¢æŸ¥å®Œæˆ]
   R --> S{transitions == 16ï¼Ÿ}
   S -->|Yes| T["correct!" â†’ exit 0]
   S -->|No| U["wrong!" â†’ exit 1]
</div>
<details data-callout="" data-callout-type="example" open>
<summary data-callout-title="">èˆ‰ç¬¬ä¸€å€‹å­—å…ƒæ¯”è¼ƒçš„ä¾‹å­</summary>
<div data-callout-body="">
<p>èˆ‰å€‹ä¾‹å­ç¬¬ä¸€å€‹å­—çš„æ¯”è¼ƒæœƒæ˜¯case 0
<code>jumptable 000000014000CA5A </code> ç„¶å¾Œé€²å»æ¯”è¼ƒJ/U/iä¸‰å€‹ä¸åŒçš„åˆ†æ”¯</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="c"><code><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0000000140860241</span><span style="--0:#E1E4E8;--1:#24292E"> loc_140860241:                          ; CODE XREF: sub_14000C0B0</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">9AA</span><span style="--0:#E1E4E8;--1:#24292E">â†‘j</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0000000140860241</span><span style="--0:#E1E4E8;--1:#24292E"> rdtsc                                   ; jumptable </span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">000000014000CA5A</span><span style="--0:#E1E4E8;--1:#24292E"> case </span><span style="--0:#79B8FF;--1:#005CC5">0</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0000000140860243</span><span style="--0:#E1E4E8;--1:#24292E"> shl     rdx, </span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">20h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0000000140860247</span><span style="--0:#E1E4E8;--1:#24292E"> or      rax, rdx</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">000000014086024A</span><span style="--0:#E1E4E8;--1:#24292E"> mov     [rsp</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">59398h</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E">var_680], rax</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0000000140860252</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0000000140860252</span><span style="--0:#E1E4E8;--1:#24292E"> loc_140860252:                          ; CODE XREF: sub_14000C0B0</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">8541CF</span><span style="--0:#E1E4E8;--1:#24292E">â†“j</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0000000140860252</span><span style="--0:#E1E4E8;--1:#24292E"> rdtsc</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0000000140860254</span><span style="--0:#E1E4E8;--1:#24292E"> shl     rdx, </span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">20h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0000000140860258</span><span style="--0:#E1E4E8;--1:#24292E"> or      rax, rdx</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">000000014086025B</span><span style="--0:#E1E4E8;--1:#24292E"> mov     [rsp</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">59398h</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E">var_678], rax</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0000000140860263</span><span style="--0:#E1E4E8;--1:#24292E"> mov     rax, [rsp</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">59398h</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E">var_680]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">000000014086026B</span><span style="--0:#E1E4E8;--1:#24292E"> mov     rcx, [rsp</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">59398h</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E">var_678]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0000000140860273</span><span style="--0:#E1E4E8;--1:#24292E"> sub     rcx, rax</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0000000140860276</span><span style="--0:#E1E4E8;--1:#24292E"> mov     rax, rcx</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0000000140860279</span><span style="--0:#E1E4E8;--1:#24292E"> cmp     rax, </span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">12AD1659h</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">000000014086027</span><span style="--0:#F97583;--1:#BF3441">F</span><span style="--0:#E1E4E8;--1:#24292E"> jl      </span><span style="--0:#F97583;--1:#BF3441">short</span><span style="--0:#E1E4E8;--1:#24292E"> loc_140860252</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0000000140860281</span><span style="--0:#E1E4E8;--1:#24292E"> movzx   eax, [rsp</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">59398h</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E">var_59368]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0000000140860286</span><span style="--0:#E1E4E8;--1:#24292E"> mov     [rsp</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">59398h</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E">var_1D80C], al</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">000000014086028D</span><span style="--0:#E1E4E8;--1:#24292E"> cmp     [rsp</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">59398h</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E">var_1D80C], </span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">4Ah</span><span style="--0:#E1E4E8;--1:#24292E"> ; </span><span style="--0:#9ECBFF;--1:#032F62">'J'</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0000000140860295</span><span style="--0:#E1E4E8;--1:#24292E"> jz      </span><span style="--0:#F97583;--1:#BF3441">short</span><span style="--0:#E1E4E8;--1:#24292E"> loc_1408602CE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0000000140860297</span><span style="--0:#E1E4E8;--1:#24292E"> cmp     [rsp</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">59398h</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E">var_1D80C], </span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">55h</span><span style="--0:#E1E4E8;--1:#24292E"> ; </span><span style="--0:#9ECBFF;--1:#032F62">'U'</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">000000014086029</span><span style="--0:#F97583;--1:#BF3441">F</span><span style="--0:#E1E4E8;--1:#24292E"> jz      </span><span style="--0:#F97583;--1:#BF3441">short</span><span style="--0:#E1E4E8;--1:#24292E"> loc_1408602EF</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">00000001408602A1</span><span style="--0:#E1E4E8;--1:#24292E"> cmp     [rsp</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">59398h</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E">var_1D80C], </span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">69h</span><span style="--0:#E1E4E8;--1:#24292E"> ; </span><span style="--0:#9ECBFF;--1:#032F62">'i'</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">00000001408602A9</span><span style="--0:#E1E4E8;--1:#24292E"> jz      </span><span style="--0:#F97583;--1:#BF3441">short</span><span style="--0:#E1E4E8;--1:#24292E"> loc_1408602AD</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">00000001408602AB</span><span style="--0:#E1E4E8;--1:#24292E"> jmp     </span><span style="--0:#F97583;--1:#BF3441">short</span><span style="--0:#E1E4E8;--1:#24292E"> loc_140860310</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code=".text:0000000140860241 loc_140860241:                          ; CODE XREF: sub_14000C0B0+9AAâ†‘j.text:0000000140860241 rdtsc                                   ; jumptable 000000014000CA5A case 0.text:0000000140860243 shl     rdx, 20h.text:0000000140860247 or      rax, rdx.text:000000014086024A mov     [rsp+59398h+var_680], rax.text:0000000140860252.text:0000000140860252 loc_140860252:                          ; CODE XREF: sub_14000C0B0+8541CFâ†“j.text:0000000140860252 rdtsc.text:0000000140860254 shl     rdx, 20h.text:0000000140860258 or      rax, rdx.text:000000014086025B mov     [rsp+59398h+var_678], rax.text:0000000140860263 mov     rax, [rsp+59398h+var_680].text:000000014086026B mov     rcx, [rsp+59398h+var_678].text:0000000140860273 sub     rcx, rax.text:0000000140860276 mov     rax, rcx.text:0000000140860279 cmp     rax, 12AD1659h.text:000000014086027F jl      short loc_140860252.text:0000000140860281 movzx   eax, [rsp+59398h+var_59368].text:0000000140860286 mov     [rsp+59398h+var_1D80C], al.text:000000014086028D cmp     [rsp+59398h+var_1D80C], 4Ah ; &#x27;J&#x27;.text:0000000140860295 jz      short loc_1408602CE.text:0000000140860297 cmp     [rsp+59398h+var_1D80C], 55h ; &#x27;U&#x27;.text:000000014086029F jz      short loc_1408602EF.text:00000001408602A1 cmp     [rsp+59398h+var_1D80C], 69h ; &#x27;i&#x27;.text:00000001408602A9 jz      short loc_1408602AD.text:00000001408602AB jmp     short loc_140860310"><div></div></button></div></figure></div>
<p>é‚£ä¸‰å€‹åˆ†æ”¯æœƒè¨­å®šä¸åŒçš„ç‹€æ…‹ç„¶å¾Œæœ€å¾Œéƒ½æœƒè·‘åˆ°<code>140860310</code></p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="python"><code><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">000000140860310</span><span style="--0:#E1E4E8;--1:#24292E"> loc_140860310:                          ; </span><span style="--0:#79B8FF;--1:#005CC5">CODE</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">XREF</span><span style="--0:#E1E4E8;--1:#24292E">: sub_14000C0B0</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">8541FB</span><span style="--0:#E1E4E8;--1:#24292E">â†‘j</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">000000140860310</span><span style="--0:#E1E4E8;--1:#24292E"> mov     [rsp</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">59398h</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E">nShowCmd], </span><span style="--0:#79B8FF;--1:#005CC5">5</span><span style="--0:#E1E4E8;--1:#24292E">        ; nShowCmd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">000000140860318</span><span style="--0:#E1E4E8;--1:#24292E"> mov     [rsp</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">59398h</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E">lpDirectory], </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">     ; lpDirectory</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">000000140860321</span><span style="--0:#E1E4E8;--1:#24292E"> lea     r9, aCMsgHelloThere_3024        ; </span><span style="--0:#9ECBFF;--1:#032F62">" /c msg * Hello there, Hacker"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">000000140860328</span><span style="--0:#E1E4E8;--1:#24292E"> lea     r8, aCmdExe_3024                ; </span><span style="--0:#9ECBFF;--1:#032F62">"cmd.exe"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">000000014086032F</span><span style="--0:#E1E4E8;--1:#24292E"> lea     rdx, aOpen_6196                 ; </span><span style="--0:#9ECBFF;--1:#032F62">"open"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">000000140860336</span><span style="--0:#E1E4E8;--1:#24292E"> xor     ecx, ecx                        ; hwnd</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">000000140860338</span><span style="--0:#E1E4E8;--1:#24292E"> call    cs:ShellExecuteA</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">000000014086033E</span><span style="--0:#E1E4E8;--1:#24292E"> nop</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">000000014086033F</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">000000014086033F</span><span style="--0:#E1E4E8;--1:#24292E"> loc_14086033F:                          ; </span><span style="--0:#79B8FF;--1:#005CC5">CODE</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">XREF</span><span style="--0:#E1E4E8;--1:#24292E">: sub_14000C0B0</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">85421C</span><span style="--0:#E1E4E8;--1:#24292E">â†‘j</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">000000014086033F</span><span style="--0:#E1E4E8;--1:#24292E">                                         ; sub_14000C0B0</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">85423D</span><span style="--0:#E1E4E8;--1:#24292E">â†‘j </span><span style="--0:#79B8FF;--1:#005CC5">...</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.text:</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">000000014086033F</span><span style="--0:#E1E4E8;--1:#24292E"> jmp     loc_140C685EE</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code=".text:0000000140860310 loc_140860310:                          ; CODE XREF: sub_14000C0B0+8541FBâ†‘j.text:0000000140860310 mov     [rsp+59398h+nShowCmd], 5        ; nShowCmd.text:0000000140860318 mov     [rsp+59398h+lpDirectory], 0     ; lpDirectory.text:0000000140860321 lea     r9, aCMsgHelloThere_3024        ; &#x22; /c msg * Hello there, Hacker&#x22;.text:0000000140860328 lea     r8, aCmdExe_3024                ; &#x22;cmd.exe&#x22;.text:000000014086032F lea     rdx, aOpen_6196                 ; &#x22;open&#x22;.text:0000000140860336 xor     ecx, ecx                        ; hwnd.text:0000000140860338 call    cs:ShellExecuteA.text:000000014086033E nop.text:000000014086033F.text:000000014086033F loc_14086033F:                          ; CODE XREF: sub_14000C0B0+85421Câ†‘j.text:000000014086033F                                         ; sub_14000C0B0+85423Dâ†‘j ....text:000000014086033F jmp     loc_140C685EE"><div></div></button></div></figure></div>
</div>
</details>
<hr>
<p><strong>æ–¼æ˜¯æˆ‘å€‘æœ‰å€‹æƒ³æ³•</strong>
<strong>1. æ‹¿åˆ°è·³è½‰è¡¨</strong>
<strong>2. å»ºç«‹æ¨¹ç‹€çµæ§‹</strong>
<strong>3. ç”¨DFSæˆ–æ˜¯å…¶ä»–æ–¹æ³•æ‰¾åˆ°æ­£ç¢ºçš„è·¯å¾‘</strong></p>
<h5 id="é‡æ¸…èˆ‡é€†å‘part1-è·³è½‰è¡¨">é‡æ¸…èˆ‡é€†å‘PART1. è·³è½‰è¡¨</h5>
<p>done, tbc</p>
<h5 id="é‡æ¸…èˆ‡é€†å‘part2-ç”Ÿæˆfns-funcè£¡é¢çš„å­—ä¸²æ¯”è¼ƒ">é‡æ¸…èˆ‡é€†å‘PART2. ç”ŸæˆFNS (funcè£¡é¢çš„å­—ä¸²æ¯”è¼ƒ)</h5>
<p>done, tbc</p>
<h5 id="é‡æ¸…èˆ‡é€†å‘part3é–‹ædfs">é‡æ¸…èˆ‡é€†å‘PART3.é–‹æDFS</h5>
<p>é€™é‚Šåšåˆ°ä¸€åŠ å¥½ç´¯ ä¹‹å¾Œå†çœ‹çœ‹æœ‰æ²’æœ‰è¾¦æ³•è‡ªå·±æ“å‡ºä¾†</p>
</div>
</details>  </div> </article> </main> <footer data-astro-cid-sz7xmlte> <div class="footer-content" data-astro-cid-sz7xmlte> <div class="copyright" data-astro-cid-sz7xmlte>
&copy; 2026 Obsidian Blogger. All rights reserved.
</div> </div> </footer>  <script type="module" src="/blogs/_astro/BlogPost.astro_astro_type_script_index_0_lang.DG5eh-Mz.js"></script> </body> </html>