<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/png" href="/blogs/icon.png"><meta name="generator" content="Astro v5.1.1"><!-- Fonts --><!-- Font styles --><!-- Preload font files --><link rel="preload" href="/blogs/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/blogs/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://laudantstolam.github.io/blogs/2025aegis-writeup/"><!-- Primary Meta Tags --><title>2025AEGIS Writeup</title><meta name="title" content="2025AEGIS Writeup"><meta name="description" content="i dunno pwn, i just pwp"><meta name="keywords" content="writeup"><!-- Robots Meta Tags --><!-- Open Graph / Facebook --><meta property="og:type" content="article"><meta property="og:url" content="https://laudantstolam.github.io/blogs/2025aegis-writeup/"><meta property="og:title" content="2025AEGIS Writeup"><meta property="og:description" content="i dunno pwn, i just pwp"><meta property="og:image" content="https://raw.githubusercontent.com/Ash0645/image_remote/main/20250930101751.png"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://laudantstolam.github.io/blogs/2025aegis-writeup/"><meta property="twitter:title" content="2025AEGIS Writeup"><meta property="twitter:description" content="i dunno pwn, i just pwp"><meta property="twitter:image" content="https://raw.githubusercontent.com/Ash0645/image_remote/main/20250930101751.png"><!-- KaTeX CSS for LaTeX rendering --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"><link rel="stylesheet" href="/blogs/_astro/_slug_.BCffiVQw.css">
<link rel="stylesheet" href="/blogs/_astro/_slug_.DnqyYaEC.css">
<link rel="stylesheet" href="/blogs/_astro/_slug_.DixUw43Y.css">
<style>[data-astro-image]{width:100%;height:auto;-o-object-fit:var(--fit);object-fit:var(--fit);-o-object-position:var(--pos);object-position:var(--pos);aspect-ratio:var(--w) / var(--h)}[data-astro-image=responsive]{max-width:calc(var(--w) * 1px);max-height:calc(var(--h) * 1px)}[data-astro-image=fixed]{width:calc(var(--w) * 1px);height:calc(var(--h) * 1px)}
</style></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <div class="nav-wrapper" data-astro-cid-3ef6ksr2> <!-- <div class="nav-brand">
				<a href={getUrl('/')} class="brand-link">
					<div class="brand-icon">
						<img src={getUrl('/icon.png')} alt="icon logo" width="24" height="24" />
					</div>
					<span class="brand-text">{SITE_TITLE}</span>
				</a>
			</div> --> <div class="nav-links" data-astro-cid-3ef6ksr2> <a href="/blogs/" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Home </a>  <a href="/blogs/blog" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Blog </a>  <a href="/blogs/projects" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Projects </a>  </div> <div class="nav-actions" data-astro-cid-3ef6ksr2> <button id="theme-toggle" class="theme-toggle" title="Toggle theme" aria-label="Toggle theme" data-astro-cid-x3pjskd3> <svg width="20" height="20" viewBox="0 0 24 24" class="sun-icon" data-astro-cid-x3pjskd3> <path fill="currentColor" d="M12 18C8.68629 18 6 15.3137 6 12C6 8.68629 8.68629 6 12 6C15.3137 6 18 8.68629 18 12C18 15.3137 15.3137 18 12 18ZM12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16ZM11 1H13V4H11V1ZM11 20H13V23H11V20ZM3.51472 4.92893L4.92893 3.51472L7.05025 5.63604L5.63604 7.05025L3.51472 4.92893ZM16.9497 18.364L18.364 16.9497L20.4853 19.0711L19.0711 20.4853L16.9497 18.364ZM19.0711 3.51472L20.4853 4.92893L18.364 7.05025L16.9497 5.63604L19.0711 3.51472ZM5.63604 16.9497L7.05025 18.364L4.92893 20.4853L3.51472 19.0711L5.63604 16.9497ZM23 11V13H20V11H23ZM4 11V13H1V11H4Z" data-astro-cid-x3pjskd3></path> </svg> <svg width="20" height="20" viewBox="0 0 24 24" class="moon-icon" data-astro-cid-x3pjskd3> <path fill="currentColor" d="M10 7C10 10.866 13.134 14 17 14C18.9584 14 20.729 13.1957 21.9995 11.8995C22 11.933 22 11.9665 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C12.0335 2 12.067 2 12.1005 2.00049C10.8043 3.27098 10 5.04157 10 7ZM4 12C4 16.4183 7.58172 20 12 20C15.0583 20 17.7158 18.2839 19.062 15.7621C18.3945 15.9187 17.7035 16 17 16C12.0294 16 8 11.9706 8 7C8 6.29648 8.08133 5.60547 8.2379 4.938C5.71611 6.28423 4 8.94174 4 12Z" data-astro-cid-x3pjskd3></path> </svg> </button>  <script type="module">const m=document.getElementById("theme-toggle");function t(e){document.documentElement.setAttribute("data-theme",e),localStorage.setItem("theme",e)}function o(){const n=(document.documentElement.getAttribute("data-theme")||"dark")==="light"?"dark":"light";t(n)}function d(){const e=localStorage.getItem("theme");t(e||"dark")}m?.addEventListener("click",o);document.addEventListener("DOMContentLoaded",d);window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{localStorage.getItem("theme")||t("dark")});</script> <a href="https://github.com/laudantstolam" target="_blank" class="social-link" aria-label="GitHub" data-astro-cid-3ef6ksr2> <svg viewBox="0 0 16 16" aria-hidden="true" data-astro-cid-3ef6ksr2> <path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-3ef6ksr2></path> </svg> </a> </div> </div> </nav> </header>  <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2025-10-01T00:00:00.000Z"> Oct 1, 2025 </time>  </div> <h1 data-astro-cid-bvzihdzo>2025AEGIS Writeup</h1>  <div class="tags" data-astro-cid-bvzihdzo> <a href="/blogs/tag/writeup/" class="tag" data-astro-cid-bvzihdzo>#writeup</a> </div> <div class="hero-image" data-astro-cid-bvzihdzo> <img width="1020" height="510" src="https://raw.githubusercontent.com/Ash0645/image_remote/main/20250930101751.png" alt data-astro-cid-bvzihdzo> </div> </div> <!-- Table of Contents --> <aside class="toc-wrapper" id="toc-wrapper" data-astro-cid-bvzihdzo> <div class="toc-header" data-astro-cid-bvzihdzo> <div class="toc-title" data-astro-cid-bvzihdzo> <span data-astro-cid-bvzihdzo>👀</span> <button class="toc-minimize-btn" id="toc-minimize-btn" aria-label="Toggle TOC" data-astro-cid-bvzihdzo> <span id="toc-icon" data-astro-cid-bvzihdzo>−</span> </button> </div> </div> <div class="toc-content" data-astro-cid-bvzihdzo> <ul class="toc-list" id="toc-list" data-astro-cid-bvzihdzo></ul> </div> </aside>  <p>這次神盾各領域都是2題 差一點點進決賽QQ (10-13名都同分 比時間QQ)
負責了misc的通靈部分跟rev的兩題 pwn解到漏洞利用了但是卡在最後一步
這是隊友的 crypto WP -> <a href="https://hackmd.io/@eeeeee/BkXJPDHhgg">https://hackmd.io/@eeeeee/BkXJPDHhgg</a></p>





















<table><thead><tr><th align="left"><font color="#c0504d">total</font></th><th align="left">Reverse</th><th align="left">Pwn</th><th align="left">Web</th><th align="left">Crypto</th><th align="left">Misc/Forensic</th></tr></thead><tbody><tr><td align="left">2</td><td align="left">2.5</td><td align="left">0.5</td><td align="left">0</td><td align="left">0</td><td align="left">0</td></tr></tbody></table>






























<table><thead><tr><th align="left">challenge</th><th align="left">difficulty</th><th>genere</th></tr></thead><tbody><tr><td align="left">gochal</td><td align="left">💔</td><td>Reverse</td></tr><tr><td align="left">callback</td><td align="left">💔</td><td>Reverse</td></tr><tr><td align="left">minielf</td><td align="left">💔💔</td><td>Reverse</td></tr><tr><td align="left">n2</td><td align="left">💔💔</td><td>Pwn</td></tr></tbody></table>
<h2 id="reverse">Reverse</h2>
<h3 id="gochal">gochal</h3>
<p>又是100分爛題嗚嗚
IDA翻翻找找看到有一個叫<code>main_checkFlag</code>的func 裡面再做簡單的<code>base64+XOR</code>字串處理</p>
<div class="expressive-code"><link rel="stylesheet" href="/blogs/_astro/ec.0niu6.css"><script type="module" src="/blogs/_astro/ec.8zarh.js"></script><figure class="frame"><figcaption class="header"></figcaption><pre data-language="c"><code><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">__int64 v35;</span><span style="--0:#99A0A6;--1:#616972"> // [rsp-8h] [rbp-70h]</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">char</span><span style="--0:#E1E4E8;--1:#24292E"> v36;</span><span style="--0:#99A0A6;--1:#616972"> // [rsp+15h] [rbp-53h] BYREF</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">char</span><span style="--0:#E1E4E8;--1:#24292E"> v37;</span><span style="--0:#99A0A6;--1:#616972"> // [rsp+35h] [rbp-33h] BYREF</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">char</span><span style="--0:#E1E4E8;--1:#24292E"> n26;</span><span style="--0:#99A0A6;--1:#616972"> // [rsp+55h] [rbp-13h]</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">__int16 n15403;</span><span style="--0:#99A0A6;--1:#616972"> // [rsp+56h] [rbp-12h]</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">__int64 v40;</span><span style="--0:#99A0A6;--1:#616972"> // [rsp+58h] [rbp-10h]</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">__int64 v41;</span><span style="--0:#99A0A6;--1:#616972"> // [rsp+60h] [rbp-8h]</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">n26 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">1A</span><span style="--0:#E1E4E8;--1:#24292E">;</span><span style="--0:#99A0A6;--1:#616972"> // XOR's num</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">n15403 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">3C2B</span><span style="--0:#E1E4E8;--1:#24292E">;</span><span style="--0:#99A0A6;--1:#616972"> // XOR's num</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">v9 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">encoding_base64__ptr_Encoding_DecodeString</span><span style="--0:#E1E4E8;--1:#24292E">(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">         </span></span><span style="--0:#E1E4E8;--1:#24292E">runtime_bss,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">         </span></span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">unsigned</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">int</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#9ECBFF;--1:#032F62">"W257U3hHXURjfERORUlOdUBZRUJSRV9Uc1hjfUpRfwpB"</span><span style="--0:#E1E4E8;--1:#24292E">,</span><span style="--0:#99A0A6;--1:#616972"> //raw str</span></div></div><div class="ec-line"><div class="code"><span class="indent">         </span><span style="--0:#79B8FF;--1:#005CC5">44</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">         </span></span><span style="--0:#E1E4E8;--1:#24292E">a4,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">         </span></span><span style="--0:#E1E4E8;--1:#24292E">a5,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">         </span></span><span style="--0:#E1E4E8;--1:#24292E">a6,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">         </span></span><span style="--0:#E1E4E8;--1:#24292E">a7,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">         </span></span><span style="--0:#E1E4E8;--1:#24292E">a8,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">         </span></span><span style="--0:#E1E4E8;--1:#24292E">a9);</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> ( a4 )</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">v14 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> v9;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">v15 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">runtime_slicebytetostring</span><span style="--0:#E1E4E8;--1:#24292E">(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">          </span></span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">unsigned</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">int</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#FFAB70;--1:#AE4B07">v37</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">          </span></span><span style="--0:#E1E4E8;--1:#24292E">v9,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">          </span></span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">unsigned</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">int</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#9ECBFF;--1:#032F62">"W257U3hHXURjfERORUlOdUBZRUJSRV9Uc1hjfUpRfwpB"</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">          </span></span><span style="--0:#E1E4E8;--1:#24292E">a5,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">          </span></span><span style="--0:#E1E4E8;--1:#24292E">v10,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">          </span></span><span style="--0:#E1E4E8;--1:#24292E">v11,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">          </span></span><span style="--0:#E1E4E8;--1:#24292E">v12,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">          </span></span><span style="--0:#E1E4E8;--1:#24292E">v13,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">          </span></span><span style="--0:#E1E4E8;--1:#24292E">v33);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">v40 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> v14;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">v41 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> v15;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">v20 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">runtime_makeslice</span><span style="--0:#E1E4E8;--1:#24292E">((</span><span style="--0:#F97583;--1:#BF3441">unsigned</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">int</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#FFAB70;--1:#AE4B07">RTYPE_uint8</span><span style="--0:#E1E4E8;--1:#24292E">, v14, v14, </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">, a5, v16, v17, v18, v19, v34);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">v25 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> v40;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">v26 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> v41;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972">// HERE,</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">for</span><span style="--0:#E1E4E8;--1:#24292E"> ( i </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">; v25 </span><span style="--0:#F97583;--1:#BF3441">></span><span style="--0:#E1E4E8;--1:#24292E"> i; </span><span style="--0:#F97583;--1:#BF3441">++</span><span style="--0:#E1E4E8;--1:#24292E">i )</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">{</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">v29 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> v20;</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">LODWORD</span><span style="--0:#E1E4E8;--1:#24292E">(a4) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> v25;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">n3 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> i </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">3</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E"> ((__int64)(i </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> ((</span><span style="--0:#F97583;--1:#BF3441">unsigned</span><span style="--0:#E1E4E8;--1:#24292E"> __int128)(i </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E"> (__int128)(__int64)</span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">AAAAAAAAAAAAAAAB</span><span style="--0:#F97583;--1:#BF3441">LL</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">>></span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">64</span><span style="--0:#E1E4E8;--1:#24292E">)) </span><span style="--0:#F97583;--1:#BF3441">>></span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> ( n3 </span><span style="--0:#F97583;--1:#BF3441">>=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">3</span><span style="--0:#E1E4E8;--1:#24292E"> )</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#B392F0;--1:#6F42C1">runtime_panicIndex</span><span style="--0:#E1E4E8;--1:#24292E">(n3, v29, </span><span style="--0:#79B8FF;--1:#005CC5">3</span><span style="--0:#E1E4E8;--1:#24292E">, v25);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">v21 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#F97583;--1:#BF3441">unsigned</span><span style="--0:#E1E4E8;--1:#24292E"> __int8)</span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">n26 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> n3);</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(_BYTE </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)(v29 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> i) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> v21 </span><span style="--0:#F97583;--1:#BF3441">^</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(_BYTE </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)(v26 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> i);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">v20 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> v29;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">v31 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> v20;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">v32 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">runtime_slicebytetostring</span><span style="--0:#E1E4E8;--1:#24292E">((</span><span style="--0:#F97583;--1:#BF3441">unsigned</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">int</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#FFAB70;--1:#AE4B07">v36</span><span style="--0:#E1E4E8;--1:#24292E">, v20, v25, a4, v26, v21, v22, v23, v24, v35);</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> ( v31 </span><span style="--0:#F97583;--1:#BF3441">==</span><span style="--0:#E1E4E8;--1:#24292E"> a2 )</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">runtime_memequal</span><span style="--0:#E1E4E8;--1:#24292E">(a1, v32);</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">else</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="  __int64 v35; // [rsp-8h] [rbp-70h]  char v36; // [rsp+15h] [rbp-53h] BYREF  char v37; // [rsp+35h] [rbp-33h] BYREF  char n26; // [rsp+55h] [rbp-13h]  __int16 n15403; // [rsp+56h] [rbp-12h]  __int64 v40; // [rsp+58h] [rbp-10h]  __int64 v41; // [rsp+60h] [rbp-8h]  n26 = 0x1A; // XOR&#x27;s num  n15403 = 0x3C2B; // XOR&#x27;s num  v9 = encoding_base64__ptr_Encoding_DecodeString(         runtime_bss,         (unsigned int)&#x22;W257U3hHXURjfERORUlOdUBZRUJSRV9Uc1hjfUpRfwpB&#x22;, //raw str         44,         a4,         a5,         a6,         a7,         a8,         a9);  if ( a4 )    return 0;  v14 = v9;  v15 = runtime_slicebytetostring(          (unsigned int)&#x26;v37,          v9,          (unsigned int)&#x22;W257U3hHXURjfERORUlOdUBZRUJSRV9Uc1hjfUpRfwpB&#x22;,          0,          a5,          v10,          v11,          v12,          v13,          v33);  v40 = v14;  v41 = v15;  v20 = runtime_makeslice((unsigned int)&#x26;RTYPE_uint8, v14, v14, 0, a5, v16, v17, v18, v19, v34);  v25 = v40;  v26 = v41;  // HERE,  for ( i = 0; v25 > i; ++i )  {    v29 = v20;    LODWORD(a4) = v25;    n3 = i - 3 * ((__int64)(i + ((unsigned __int128)(i * (__int128)(__int64)0xAAAAAAAAAAAAAAABLL) >> 64)) >> 1);    if ( n3 >= 3 )      runtime_panicIndex(n3, v29, 3, v25);    v21 = (unsigned __int8)*(&#x26;n26 + n3);    *(_BYTE *)(v29 + i) = v21 ^ *(_BYTE *)(v26 + i);    v20 = v29;  }  v31 = v20;  v32 = runtime_slicebytetostring((unsigned int)&#x26;v36, v20, v25, a4, v26, v21, v22, v23, v24, v35);  if ( v31 == a2 )    return runtime_memequal(a1, v32);  else    return 0;}"><div></div></button></div></figure></div>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="python"><code><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972"># Python code to decode the embedded Base64+XOR "flag" and provide a small check function.</span></div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">import</span><span style="--0:#E1E4E8;--1:#24292E"> base64, sys</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">B64 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"W257U3hHXURjfERORUlOdUBZRUJSRV9Uc1hjfUpRfwpB"</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">data </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> base64.b64decode(B64)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972"># key derived from n26 = 0x1A, n15403 = 0x3C2B (little-endian -> 0x2B, 0x3C)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">key </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">bytes</span><span style="--0:#E1E4E8;--1:#24292E">([</span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">1A</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">2B</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">3C</span><span style="--0:#E1E4E8;--1:#24292E">])</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">decoded </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">bytes</span><span style="--0:#E1E4E8;--1:#24292E">([data[i] </span><span style="--0:#F97583;--1:#BF3441">^</span><span style="--0:#E1E4E8;--1:#24292E"> key[i </span><span style="--0:#F97583;--1:#BF3441">%</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">len</span><span style="--0:#E1E4E8;--1:#24292E">(key)] </span><span style="--0:#F97583;--1:#BF3441">for</span><span style="--0:#E1E4E8;--1:#24292E"> i </span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">range</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">len</span><span style="--0:#E1E4E8;--1:#24292E">(data))])</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">FLAG</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> decoded.decode(</span><span style="--0:#9ECBFF;--1:#032F62">'utf-8'</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">print</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#9ECBFF;--1:#032F62">"Decoded:"</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#79B8FF;--1:#005CC5">print</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">FLAG</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972"># print("\nHex of decoded bytes:")</span></div></div><div class="ec-line"><div class="code"><span style="--0:#99A0A6;--1:#616972"># print(decoded.hex())</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="# Python code to decode the embedded Base64+XOR &#x22;flag&#x22; and provide a small check function.import base64, sysB64 = &#x22;W257U3hHXURjfERORUlOdUBZRUJSRV9Uc1hjfUpRfwpB&#x22;data = base64.b64decode(B64)# key derived from n26 = 0x1A, n15403 = 0x3C2B (little-endian -> 0x2B, 0x3C)key = bytes([0x1A, 0x2B, 0x3C])decoded = bytes([data[i] ^ key[i % len(key)] for i in range(len(data))])FLAG = decoded.decode(&#x27;utf-8&#x27;)print(&#x22;Decoded:&#x22;)print(FLAG)# print(&#x22;\nHex of decoded bytes:&#x22;)# print(decoded.hex())"><div></div></button></div></figure></div>
<blockquote>
<p><code>AEGIS{Go_for_broke_in_this_game!}</code></p>
</blockquote>
<h3 id="callback">callback</h3>
<p>這題繞了有點久 原本已經提出shell code 後面被自己+windbg繞了進去在看動態解密 其實靜態就可解了QQ
一打開IDA就看到牠缺了pdb
在看strings的時候看到有讀<code>flag.txt</code> -> 找到<code>sub_1400011C0()</code></p>
<details data-callout="" data-callout-type="note" open>
<summary data-callout-title="">source code</summary>
<div data-callout-body="">
<p></p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="c"><code><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#FFAB70;--1:#AE4B07">v21</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#FFAB70;--1:#AE4B07">v21</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">2</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">n15 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">15</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#B392F0;--1:#6F42C1">sub_1400016D0</span><span style="--0:#E1E4E8;--1:#24292E">(v21);</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#B392F0;--1:#6F42C1">memset</span><span style="--0:#E1E4E8;--1:#24292E">(Buffer, </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">sizeof</span><span style="--0:#E1E4E8;--1:#24292E">(Buffer));</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">v24 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">v25 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">v26 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> ( </span><span style="--0:#B392F0;--1:#6F42C1">fopen_s</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#FFAB70;--1:#AE4B07">Stream</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#9ECBFF;--1:#032F62">"flag.txt"</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#9ECBFF;--1:#032F62">"r"</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">||</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">!</span><span style="--0:#E1E4E8;--1:#24292E">Stream )</span><span style="--0:#99A0A6;--1:#616972"> //readfile</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#B392F0;--1:#6F42C1">MessageBoxW</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">, aCanTFindOrOpen, L</span><span style="--0:#9ECBFF;--1:#032F62">"ERROR"</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">10</span><span style="--0:#F97583;--1:#BF3441">u</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#B392F0;--1:#6F42C1">PostQuitMessage</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> ( n15 </span><span style="--0:#F97583;--1:#BF3441">&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">10</span><span style="--0:#E1E4E8;--1:#24292E"> )</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">v11 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#FFAB70;--1:#AE4B07">v21</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">];</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> ( n15 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">1000</span><span style="--0:#E1E4E8;--1:#24292E"> )</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#F97583;--1:#BF3441">goto</span><span style="--0:#E1E4E8;--1:#24292E"> LABEL_8;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">v11 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">**</span><span style="--0:#E1E4E8;--1:#24292E">)(</span><span style="--0:#FFAB70;--1:#AE4B07">v21</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">8</span><span style="--0:#F97583;--1:#BF3441">LL</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> ( (</span><span style="--0:#F97583;--1:#BF3441">unsigned</span><span style="--0:#E1E4E8;--1:#24292E"> __int64)(</span><span style="--0:#FFAB70;--1:#AE4B07">v21</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#E1E4E8;--1:#24292E"> (_QWORD)v11 </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">8</span><span style="--0:#F97583;--1:#BF3441">LL</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">&#x3C;=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">1F</span><span style="--0:#E1E4E8;--1:#24292E"> )</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#F97583;--1:#BF3441">goto</span><span style="--0:#E1E4E8;--1:#24292E"> LABEL_8;</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">goto</span><span style="--0:#E1E4E8;--1:#24292E"> LABEL_24;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#B392F0;--1:#6F42C1">fread</span><span style="--0:#E1E4E8;--1:#24292E">(Buffer, </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#F97583;--1:#BF3441">u</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">2C</span><span style="--0:#F97583;--1:#BF3441">u</span><span style="--0:#E1E4E8;--1:#24292E">, Stream);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">v26 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#B392F0;--1:#6F42C1">fclose</span><span style="--0:#E1E4E8;--1:#24292E">(Stream);</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(_OWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)WideCharStr </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">v28 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">v29 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">v30 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">v31 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">v32 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">v33 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#B392F0;--1:#6F42C1">MultiByteToWideChar</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">, (LPCCH)</span><span style="--0:#FFAB70;--1:#AE4B07">Buffer</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">, WideCharStr, </span><span style="--0:#79B8FF;--1:#005CC5">45</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">lpAddress_1 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#B392F0;--1:#6F42C1">__int64</span><span style="--0:#E1E4E8;--1:#24292E"> (__fastcall </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)(_OWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">))</span><span style="--0:#B392F0;--1:#6F42C1">VirtualAlloc</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">272</span><span style="--0:#F97583;--1:#BF3441">u</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">1000</span><span style="--0:#F97583;--1:#BF3441">u</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">40</span><span style="--0:#F97583;--1:#BF3441">u</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">lpAddress </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> lpAddress_1;</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> ( </span><span style="--0:#F97583;--1:#BF3441">!</span><span style="--0:#E1E4E8;--1:#24292E">lpAddress_1 )</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">{</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">v10 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">sub_140001840</span><span style="--0:#E1E4E8;--1:#24292E">(std::cerr);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">std::ostream::operator</span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">(v10, sub_140001A00);</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">goto</span><span style="--0:#E1E4E8;--1:#24292E"> LABEL_5;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">lpAddress_2 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#B392F0;--1:#6F42C1">__int64</span><span style="--0:#E1E4E8;--1:#24292E"> (__fastcall </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)(_QWORD))lpAddress_1;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">v14 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">unk_140005040;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">n4 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">4</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">do</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(_OWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)lpAddress_2 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">v14;</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_OWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)lpAddress_2 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">v14</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">];</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_OWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)lpAddress_2 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">2</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">v14</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">2</span><span style="--0:#E1E4E8;--1:#24292E">];</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_OWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)lpAddress_2 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">3</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">v14</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">3</span><span style="--0:#E1E4E8;--1:#24292E">];</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_OWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)lpAddress_2 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">4</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">v14</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">4</span><span style="--0:#E1E4E8;--1:#24292E">];</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_OWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)lpAddress_2 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">5</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">v14</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">5</span><span style="--0:#E1E4E8;--1:#24292E">];</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_OWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)lpAddress_2 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">6</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">v14</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">6</span><span style="--0:#E1E4E8;--1:#24292E">];</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">lpAddress_2 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#B392F0;--1:#6F42C1">__int64</span><span style="--0:#E1E4E8;--1:#24292E"> (__fastcall </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)(_QWORD))((</span><span style="--0:#F97583;--1:#BF3441">char</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)lpAddress_2 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">128</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_OWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)lpAddress_2 </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">v14</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">7</span><span style="--0:#E1E4E8;--1:#24292E">];</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">v14 </span><span style="--0:#F97583;--1:#BF3441">+=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">8</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">--</span><span style="--0:#E1E4E8;--1:#24292E">n4;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">while</span><span style="--0:#E1E4E8;--1:#24292E"> ( n4 );</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(_OWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)lpAddress_2 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">v14;</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_OWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)lpAddress_2 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">v14</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">];</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_OWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)lpAddress_2 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">2</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">v14</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">2</span><span style="--0:#E1E4E8;--1:#24292E">];</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_OWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)lpAddress_2 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">3</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">v14</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">3</span><span style="--0:#E1E4E8;--1:#24292E">];</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_OWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)lpAddress_2 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">4</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">v14</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">4</span><span style="--0:#E1E4E8;--1:#24292E">];</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_OWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)lpAddress_2 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">5</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">v14</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">5</span><span style="--0:#E1E4E8;--1:#24292E">];</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_OWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)lpAddress_2 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">6</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">v14</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">6</span><span style="--0:#E1E4E8;--1:#24292E">];</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_WORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)lpAddress_2 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">56</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_WORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)v14 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">56</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> ( Msg </span><span style="--0:#F97583;--1:#BF3441">==</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1140</span><span style="--0:#E1E4E8;--1:#24292E"> )</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">{</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">v16 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">lpAddress</span><span style="--0:#E1E4E8;--1:#24292E">(Buffer);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">OK_right_ </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> L</span><span style="--0:#9ECBFF;--1:#032F62">"OK right!!"</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> ( v16 </span><span style="--0:#F97583;--1:#BF3441">!=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E"> )</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">     </span></span><span style="--0:#E1E4E8;--1:#24292E">OK_right_ </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> L</span><span style="--0:#9ECBFF;--1:#032F62">"Sorry......Keep it up"</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#B392F0;--1:#6F42C1">MessageBoxW</span><span style="--0:#E1E4E8;--1:#24292E">(hWnd, OK_right_, L</span><span style="--0:#9ECBFF;--1:#032F62">"&#x3C;&#x3C; MSG >>"</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#B392F0;--1:#6F42C1">VirtualFree</span><span style="--0:#E1E4E8;--1:#24292E">(lpAddress, </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">8000</span><span style="--0:#F97583;--1:#BF3441">u</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#B392F0;--1:#6F42C1">PostQuitMessage</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">LABEL_5:</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> ( n15 </span><span style="--0:#F97583;--1:#BF3441">&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">10</span><span style="--0:#E1E4E8;--1:#24292E"> )</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">v11 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#FFAB70;--1:#AE4B07">v21</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">];</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> ( n15 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">1000</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">||</span><span style="--0:#E1E4E8;--1:#24292E"> (v11 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">**</span><span style="--0:#E1E4E8;--1:#24292E">)(</span><span style="--0:#FFAB70;--1:#AE4B07">v21</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">8</span><span style="--0:#F97583;--1:#BF3441">LL</span><span style="--0:#E1E4E8;--1:#24292E">), (</span><span style="--0:#F97583;--1:#BF3441">unsigned</span><span style="--0:#E1E4E8;--1:#24292E"> __int64)(</span><span style="--0:#FFAB70;--1:#AE4B07">v21</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#E1E4E8;--1:#24292E"> (_QWORD)v11 </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">8</span><span style="--0:#F97583;--1:#BF3441">LL</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">&#x3C;=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">1F</span><span style="--0:#E1E4E8;--1:#24292E">) )</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">{</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">LABEL_8:</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#B392F0;--1:#6F42C1">j_j_free</span><span style="--0:#E1E4E8;--1:#24292E">(v11);</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">LABEL_24:</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#B392F0;--1:#6F42C1">invalid_parameter_noinfo_noreturn</span><span style="--0:#E1E4E8;--1:#24292E">();</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#B392F0;--1:#6F42C1">VirtualFree</span><span style="--0:#E1E4E8;--1:#24292E">(lpAddress, </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">8000</span><span style="--0:#F97583;--1:#BF3441">u</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">v18 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">DefWindowProcW</span><span style="--0:#E1E4E8;--1:#24292E">(hWnd, Msg, wParam, lParam);</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> ( n15 </span><span style="--0:#F97583;--1:#BF3441">>=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">10</span><span style="--0:#E1E4E8;--1:#24292E"> )</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">{</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">v19 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#FFAB70;--1:#AE4B07">v21</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">];</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> ( n15 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">>=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">1000</span><span style="--0:#E1E4E8;--1:#24292E"> )</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">{</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">     </span></span><span style="--0:#E1E4E8;--1:#24292E">v19 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">**</span><span style="--0:#E1E4E8;--1:#24292E">)(</span><span style="--0:#FFAB70;--1:#AE4B07">v21</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">8</span><span style="--0:#F97583;--1:#BF3441">LL</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> ( (</span><span style="--0:#F97583;--1:#BF3441">unsigned</span><span style="--0:#E1E4E8;--1:#24292E"> __int64)(</span><span style="--0:#FFAB70;--1:#AE4B07">v21</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#E1E4E8;--1:#24292E"> (_QWORD)v19 </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">8</span><span style="--0:#F97583;--1:#BF3441">LL</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">></span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">1F</span><span style="--0:#E1E4E8;--1:#24292E"> )</span></div></div><div class="ec-line"><div class="code"><span class="indent">       </span><span style="--0:#F97583;--1:#BF3441">goto</span><span style="--0:#E1E4E8;--1:#24292E"> LABEL_24;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#B392F0;--1:#6F42C1">j_j_free</span><span style="--0:#E1E4E8;--1:#24292E">(v19);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> v18;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code=" v21[0] = 0; v21[2] = 0; n15 = 15; sub_1400016D0(v21); memset(Buffer, 0, sizeof(Buffer)); v24 = 0; v25 = 0; v26 = 0; if ( fopen_s(&#x26;Stream, &#x22;flag.txt&#x22;, &#x22;r&#x22;) || !Stream ) //readfile {   MessageBoxW(0, aCanTFindOrOpen, L&#x22;ERROR&#x22;, 0x10u);   PostQuitMessage(0);   if ( n15 < 0x10 )     return 0;   v11 = (void *)v21[0];   if ( n15 + 1 < 0x1000 )     goto LABEL_8;   v11 = *(void **)(v21[0] - 8LL);   if ( (unsigned __int64)(v21[0] - (_QWORD)v11 - 8LL) <= 0x1F )     goto LABEL_8;   goto LABEL_24; } fread(Buffer, 1u, 0x2Cu, Stream); v26 = 0; fclose(Stream); *(_OWORD *)WideCharStr = 0; v28 = 0; v29 = 0; v30 = 0; v31 = 0; v32 = 0; v33 = 0; MultiByteToWideChar(0, 0, (LPCCH)Buffer, -1, WideCharStr, 45); lpAddress_1 = (__int64 (__fastcall *)(_OWORD *))VirtualAlloc(0, 0x272u, 0x1000u, 0x40u); lpAddress = lpAddress_1; if ( !lpAddress_1 ) {   v10 = sub_140001840(std::cerr);   std::ostream::operator<<(v10, sub_140001A00);   goto LABEL_5; } lpAddress_2 = (__int64 (__fastcall *)(_QWORD))lpAddress_1; v14 = &#x26;unk_140005040; n4 = 4; do {   *(_OWORD *)lpAddress_2 = *v14;   *((_OWORD *)lpAddress_2 + 1) = v14[1];   *((_OWORD *)lpAddress_2 + 2) = v14[2];   *((_OWORD *)lpAddress_2 + 3) = v14[3];   *((_OWORD *)lpAddress_2 + 4) = v14[4];   *((_OWORD *)lpAddress_2 + 5) = v14[5];   *((_OWORD *)lpAddress_2 + 6) = v14[6];   lpAddress_2 = (__int64 (__fastcall *)(_QWORD))((char *)lpAddress_2 + 128);   *((_OWORD *)lpAddress_2 - 1) = v14[7];   v14 += 8;   --n4; } while ( n4 ); *(_OWORD *)lpAddress_2 = *v14; *((_OWORD *)lpAddress_2 + 1) = v14[1]; *((_OWORD *)lpAddress_2 + 2) = v14[2]; *((_OWORD *)lpAddress_2 + 3) = v14[3]; *((_OWORD *)lpAddress_2 + 4) = v14[4]; *((_OWORD *)lpAddress_2 + 5) = v14[5]; *((_OWORD *)lpAddress_2 + 6) = v14[6]; *((_WORD *)lpAddress_2 + 56) = *((_WORD *)v14 + 56); if ( Msg == 1140 ) {   v16 = lpAddress(Buffer);   OK_right_ = L&#x22;OK right!!&#x22;;   if ( v16 != 1 )     OK_right_ = L&#x22;Sorry......Keep it up&#x22;;   MessageBoxW(hWnd, OK_right_, L&#x22;<< MSG >>&#x22;, 0);   VirtualFree(lpAddress, 0, 0x8000u);   PostQuitMessage(0);LABEL_5:   if ( n15 < 0x10 )     return 0;   v11 = (void *)v21[0];   if ( n15 + 1 < 0x1000 || (v11 = *(void **)(v21[0] - 8LL), (unsigned __int64)(v21[0] - (_QWORD)v11 - 8LL) <= 0x1F) )   {LABEL_8:     j_j_free(v11);     return 0;   }LABEL_24:   invalid_parameter_noinfo_noreturn(); } VirtualFree(lpAddress, 0, 0x8000u); v18 = DefWindowProcW(hWnd, Msg, wParam, lParam); if ( n15 >= 0x10 ) {   v19 = (void *)v21[0];   if ( n15 + 1 >= 0x1000 )   {     v19 = *(void **)(v21[0] - 8LL);     if ( (unsigned __int64)(v21[0] - (_QWORD)v19 - 8LL) > 0x1F )       goto LABEL_24;   }   j_j_free(v19); } return v18;}"><div></div></button></div></figure></div>
</div>
</details>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="c"><code><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">lpAddress_1 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> ( (</span><span style="--0:#B392F0;--1:#6F42C1">__int64</span><span style="--0:#E1E4E8;--1:#24292E"> (__fastcall </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)(_OWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">))</span></div></div><div class="ec-line"><div class="code"><span class="indent">                </span><span style="--0:#B392F0;--1:#6F42C1">VirtualAlloc</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">272</span><span style="--0:#F97583;--1:#BF3441">u</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">1000</span><span style="--0:#F97583;--1:#BF3441">u</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">40</span><span style="--0:#F97583;--1:#BF3441">u</span><span style="--0:#E1E4E8;--1:#24292E">) );</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">lpAddress </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> lpAddress_1;</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="lpAddress_1 = ( (__int64 (__fastcall *)(_OWORD *))                VirtualAlloc(0, 0x272u, 0x1000u, 0x40u) );lpAddress = lpAddress_1;"><div></div></button></div></figure></div>
<p>這裡用 VirtualAlloc 搞了一塊可讀可寫的記憶體 後面宣告成func ptr來執行(<code>__int64 (__fastcall *)(_OWORD *)</code>) 推測之後會被當成函數呼叫</p>
<details data-callout="" data-callout-type="tip" open>
<summary data-callout-title="">references</summary>
<div data-callout-body="">
<p></p>
<p>看到 virtualAlloc 基本都很sus</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="c"><code><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">LPVOID </span><span style="--0:#B392F0;--1:#6F42C1">VirtualAlloc</span><span style="--0:#E1E4E8;--1:#24292E">(</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">[in, optional] LPVOID </span><span style="--0:#FFAB70;--1:#AE4B07">lpAddress</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">[in]           SIZE_T </span><span style="--0:#FFAB70;--1:#AE4B07">dwSize</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">--></span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">272</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">[in]           DWORD  </span><span style="--0:#FFAB70;--1:#AE4B07">flAllocationType</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">[in]           DWORD  flProtect </span><span style="--0:#F97583;--1:#BF3441">--></span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">40</span><span style="--0:#E1E4E8;--1:#24292E">, PAGE_EXECUTE_READWRITE</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="LPVOID VirtualAlloc( [in, optional] LPVOID lpAddress, [in]           SIZE_T dwSize, --> 0x272 [in]           DWORD  flAllocationType, [in]           DWORD  flProtect --> 0x40, PAGE_EXECUTE_READWRITE);"><div></div></button></div></figure></div>
<p>其中
<code>0x40</code>, <strong>PAGE_EXECUTE_READWRITE</strong>, 啟用對已認可頁面區域的執行、唯讀或讀取/寫入存取權。</p>
</div>
</details>
<p>之後把<code>&#x26;unk_140005040</code>的東西塞進去那塊記憶體去執行
但是那堆東西看進去是一段被放在data的<code>shellcode</code>，開頭的東西是<code>55 48 8B EC</code> 對應了 <code>push rbp; mov rbp, rsp</code></p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="c"><code><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.data:</span><span style="--0:#F97583;--1:#BF3441">0</span><span style="--0:#79B8FF;--1:#005CC5">000000140005040</span><span style="--0:#E1E4E8;--1:#24292E"> unk_140005040   db  </span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">55h</span><span style="--0:#E1E4E8;--1:#24292E"> ; U             ; DATA XREF: sub_1400011C0</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">1A0</span><span style="--0:#E1E4E8;--1:#24292E">↑o</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.data:</span><span style="--0:#F97583;--1:#BF3441">0</span><span style="--0:#79B8FF;--1:#005CC5">000000140005041</span><span style="--0:#E1E4E8;--1:#24292E">                 db  </span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">48h</span><span style="--0:#E1E4E8;--1:#24292E"> ; H</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.data:</span><span style="--0:#F97583;--1:#BF3441">0</span><span style="--0:#79B8FF;--1:#005CC5">000000140005042</span><span style="--0:#E1E4E8;--1:#24292E">                 db  </span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">8Bh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.data:</span><span style="--0:#F97583;--1:#BF3441">0</span><span style="--0:#79B8FF;--1:#005CC5">000000140005043</span><span style="--0:#E1E4E8;--1:#24292E">                 db </span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">0ECh</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.data:</span><span style="--0:#F97583;--1:#BF3441">0</span><span style="--0:#79B8FF;--1:#005CC5">000000140005044</span><span style="--0:#E1E4E8;--1:#24292E">                 db  </span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">48h</span><span style="--0:#E1E4E8;--1:#24292E"> ; H</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">.data:</span><span style="--0:#F97583;--1:#BF3441">0</span><span style="--0:#79B8FF;--1:#005CC5">000000140005045</span><span style="--0:#E1E4E8;--1:#24292E">                 db  </span><span style="--0:#FDAEB7;--0fs:italic;--1:#B31D28;--1fs:italic">81h</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code=".data:0000000140005040 unk_140005040   db  55h ; U             ; DATA XREF: sub_1400011C0+1A0↑o.data:0000000140005041                 db  48h ; H.data:0000000140005042                 db  8Bh.data:0000000140005043                 db 0ECh.data:0000000140005044                 db  48h ; H.data:0000000140005045                 db  81h"><div></div></button></div></figure></div>
<p>於是IDA一通操作 <code>c</code>轉換成code, 之後按<code>p</code>轉換成func就又能分析了
看到裡面做了幾個位移轉換再進行字串比較</p>
<p><strong>Step 1.</strong>
兩個字互換的swap <code>e.g. ABCD -> BADC</code>
<strong>Step 2.</strong>
四個字組成一組 <code>e.g. ABCD --> v2 = 0x41424344</code>
<strong>Step 3.</strong>
整個乘二，跟 <code>0x94E590u</code> XOR，再加20
<strong>Step 4.</strong>
進行比較</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="c"><code><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">__int64 __fastcall </span><span style="--0:#B392F0;--1:#6F42C1">sub_140005040</span><span style="--0:#E1E4E8;--1:#24292E">(__int64 </span><span style="--0:#FFAB70;--1:#AE4B07">a1</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">memset</span><span style="--0:#E1E4E8;--1:#24292E">(v8, </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">sizeof</span><span style="--0:#E1E4E8;--1:#24292E">(v8));</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">v9 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">memset</span><span style="--0:#E1E4E8;--1:#24292E">(v10, </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#F97583;--1:#BF3441">sizeof</span><span style="--0:#E1E4E8;--1:#24292E">(v10));</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">v11 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">for</span><span style="--0:#E1E4E8;--1:#24292E"> ( n42 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">; n42 </span><span style="--0:#F97583;--1:#BF3441">&#x3C;=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">42</span><span style="--0:#E1E4E8;--1:#24292E">; n42 </span><span style="--0:#F97583;--1:#BF3441">+=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">2</span><span style="--0:#E1E4E8;--1:#24292E"> )</span><span style="--0:#99A0A6;--1:#616972"> // swap in pairs</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_BYTE </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)v8 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> n42) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(_BYTE </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)(n42 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#F97583;--1:#BF3441">LL</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> a1);</span><span style="--0:#99A0A6;--1:#616972"> // v8[i] = a1+1</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_BYTE </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)v8 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> n42 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(_BYTE </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)(n42 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> a1);</span><span style="--0:#99A0A6;--1:#616972"> // v8[i+1] = a1</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">for</span><span style="--0:#E1E4E8;--1:#24292E"> ( n43 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">; n43 </span><span style="--0:#F97583;--1:#BF3441">&#x3C;=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">43</span><span style="--0:#E1E4E8;--1:#24292E">; n43 </span><span style="--0:#F97583;--1:#BF3441">+=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">4</span><span style="--0:#E1E4E8;--1:#24292E"> )</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">{</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">v2 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">for</span><span style="--0:#E1E4E8;--1:#24292E"> ( n3 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">; n3 </span><span style="--0:#F97583;--1:#BF3441">&#x3C;=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">3</span><span style="--0:#E1E4E8;--1:#24292E">; </span><span style="--0:#F97583;--1:#BF3441">++</span><span style="--0:#E1E4E8;--1:#24292E">n3 )</span><span style="--0:#99A0A6;--1:#616972"> // group in 4</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">      </span></span><span style="--0:#E1E4E8;--1:#24292E">v2 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> (v2 </span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">8</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">|</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((</span><span style="--0:#F97583;--1:#BF3441">unsigned</span><span style="--0:#E1E4E8;--1:#24292E"> __int8 </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)v8 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> n43 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> n3);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">for</span><span style="--0:#E1E4E8;--1:#24292E"> ( n3_1 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">3</span><span style="--0:#E1E4E8;--1:#24292E">; n3_1 </span><span style="--0:#F97583;--1:#BF3441">>=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">; </span><span style="--0:#F97583;--1:#BF3441">--</span><span style="--0:#E1E4E8;--1:#24292E">n3_1 )</span><span style="--0:#99A0A6;--1:#616972"> // x2 -> XOR -> +20</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_BYTE </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)v10 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">3</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#E1E4E8;--1:#24292E"> n3_1 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> n43) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> (((</span><span style="--0:#79B8FF;--1:#005CC5">2</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E"> v2) </span><span style="--0:#F97583;--1:#BF3441">^</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">94E590</span><span style="--0:#F97583;--1:#BF3441">u</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">20</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">>></span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#79B8FF;--1:#005CC5">8</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E"> n3_1);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#FFAB70;--1:#AE4B07">v12</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">6E6732F63277168A</span><span style="--0:#F97583;--1:#BF3441">LL</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#FFAB70;--1:#AE4B07">v12</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">426306DC420BFEF2</span><span style="--0:#F97583;--1:#BF3441">LL</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#FFAB70;--1:#AE4B07">v12</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">2</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">5A5BFCC65C8956D8</span><span style="--0:#F97583;--1:#BF3441">LL</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#FFAB70;--1:#AE4B07">v12</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">3</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">62397CD2602358EA</span><span style="--0:#F97583;--1:#BF3441">LL</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#FFAB70;--1:#AE4B07">v12</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">4</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">42230CD8142F2AE6</span><span style="--0:#F97583;--1:#BF3441">LL</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">n1847588040 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1847588040</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">v14 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">for</span><span style="--0:#E1E4E8;--1:#24292E"> ( n43_1 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">; n43_1 </span><span style="--0:#F97583;--1:#BF3441">&#x3C;=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">43</span><span style="--0:#E1E4E8;--1:#24292E">; </span><span style="--0:#F97583;--1:#BF3441">++</span><span style="--0:#E1E4E8;--1:#24292E">n43_1 )</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> ( </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_BYTE </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)v10 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> n43_1) </span><span style="--0:#F97583;--1:#BF3441">!=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">((_BYTE </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)v12 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> n43_1) )</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="__int64 __fastcall sub_140005040(__int64 a1){  memset(v8, 0, sizeof(v8));  v9 = 0;  memset(v10, 0, sizeof(v10));  v11 = 0;  for ( n42 = 0; n42 <= 42; n42 += 2 ) // swap in pairs  {    *((_BYTE *)v8 + n42) = *(_BYTE *)(n42 + 1LL + a1); // v8[i] = a1+1    *((_BYTE *)v8 + n42 + 1) = *(_BYTE *)(n42 + a1); // v8[i+1] = a1  }  for ( n43 = 0; n43 <= 43; n43 += 4 )  {    v2 = 0;    for ( n3 = 0; n3 <= 3; ++n3 ) // group in 4      v2 = (v2 << 8) | *((unsigned __int8 *)v8 + n43 + n3);    for ( n3_1 = 3; n3_1 >= 0; --n3_1 ) // x2 -> XOR -> +20      *((_BYTE *)v10 + 3 - n3_1 + n43) = (((2 * v2) ^ 0x94E590u) + 20) >> (8 * n3_1);  }  v12[0] = 0x6E6732F63277168ALL;  v12[1] = 0x426306DC420BFEF2LL;  v12[2] = 0x5A5BFCC65C8956D8LL;  v12[3] = 0x62397CD2602358EALL;  v12[4] = 0x42230CD8142F2AE6LL;  n1847588040 = 1847588040;  v14 = 0;  for ( n43_1 = 0; n43_1 <= 43; ++n43_1 )  {    if ( *((_BYTE *)v10 + n43_1) != *((_BYTE *)v12 + n43_1) )      return 0;  }  return 1;}"><div></div></button></div></figure></div>
<p>所以逆推就是</p>
<ul>
<li>從 <code>v12</code> 每 4 byte → 合成整數 R</li>
<li>還原 <code>v2 = ((R - 20) ^ 0x94E590) // 2</code></li>
<li>再拆成 4 byte，組合起來得到 <code>v8</code></li>
<li>最後把 pair-swap 還原 → 得到輸入 flag</li>
</ul>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="python"><code><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">def</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">invert_transform</span><span style="--0:#E1E4E8;--1:#24292E">(v12_bytes: </span><span style="--0:#79B8FF;--1:#005CC5">bytes</span><span style="--0:#E1E4E8;--1:#24292E">) -> </span><span style="--0:#79B8FF;--1:#005CC5">bytes</span><span style="--0:#E1E4E8;--1:#24292E">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">rev_str </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">bytearray</span><span style="--0:#E1E4E8;--1:#24292E">()</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">for</span><span style="--0:#E1E4E8;--1:#24292E"> i </span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">range</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#79B8FF;--1:#005CC5">len</span><span style="--0:#E1E4E8;--1:#24292E">(v12_bytes), </span><span style="--0:#79B8FF;--1:#005CC5">4</span><span style="--0:#E1E4E8;--1:#24292E">):</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">R </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">int</span><span style="--0:#E1E4E8;--1:#24292E">.from_bytes(v12_bytes[i:i</span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#79B8FF;--1:#005CC5">4</span><span style="--0:#E1E4E8;--1:#24292E">], </span><span style="--0:#9ECBFF;--1:#032F62">"big"</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">v2 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> ((R </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">20</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">^</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">94E590</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">//</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">2</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">rev_str.extend(v2.to_bytes(</span><span style="--0:#79B8FF;--1:#005CC5">4</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#9ECBFF;--1:#032F62">"big"</span><span style="--0:#E1E4E8;--1:#24292E">))</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#99A0A6;--1:#616972"># word swap</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">recovered </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">bytearray</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">len</span><span style="--0:#E1E4E8;--1:#24292E">(rev_str))</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">for</span><span style="--0:#E1E4E8;--1:#24292E"> i </span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">range</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#79B8FF;--1:#005CC5">len</span><span style="--0:#E1E4E8;--1:#24292E">(rev_str), </span><span style="--0:#79B8FF;--1:#005CC5">2</span><span style="--0:#E1E4E8;--1:#24292E">):</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">recovered[i] </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> rev_str[i </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">]</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">recovered[i </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> rev_str[i]</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">bytes</span><span style="--0:#E1E4E8;--1:#24292E">(recovered)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">__name__</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">==</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"__main__"</span><span style="--0:#E1E4E8;--1:#24292E">:</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">v12_parts </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> [</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">6E6732F63277168A</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">426306DC420BFEF2</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">5A5BFCC65C8956D8</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">62397CD2602358EA</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">42230CD8142F2AE6</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">]</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">n1847588040 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">6E1FF4C8</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">v12 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">b</span><span style="--0:#9ECBFF;--1:#032F62">""</span><span style="--0:#E1E4E8;--1:#24292E">.join(p.to_bytes(</span><span style="--0:#79B8FF;--1:#005CC5">8</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#9ECBFF;--1:#032F62">"little"</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">for</span><span style="--0:#E1E4E8;--1:#24292E"> p </span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#E1E4E8;--1:#24292E"> v12_parts)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">v12 </span><span style="--0:#F97583;--1:#BF3441">+=</span><span style="--0:#E1E4E8;--1:#24292E"> n1847588040.to_bytes(</span><span style="--0:#79B8FF;--1:#005CC5">4</span><span style="--0:#E1E4E8;--1:#24292E">, </span><span style="--0:#9ECBFF;--1:#032F62">"little"</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">flag </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> invert_transform(v12)</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#79B8FF;--1:#005CC5">print</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#9ECBFF;--1:#032F62">"flag:"</span><span style="--0:#E1E4E8;--1:#24292E">, flag)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="def invert_transform(v12_bytes: bytes) -> bytes:    rev_str = bytearray()    for i in range(0, len(v12_bytes), 4):        R = int.from_bytes(v12_bytes[i:i+4], &#x22;big&#x22;)        v2 = ((R - 20) ^ 0x94E590) // 2        rev_str.extend(v2.to_bytes(4, &#x22;big&#x22;))    # word swap    recovered = bytearray(len(rev_str))    for i in range(0, len(rev_str), 2):        recovered[i] = rev_str[i + 1]        recovered[i + 1] = rev_str[i]    return bytes(recovered)if __name__ == &#x22;__main__&#x22;:    v12_parts = [        0x6E6732F63277168A,        0x426306DC420BFEF2,        0x5A5BFCC65C8956D8,        0x62397CD2602358EA,        0x42230CD8142F2AE6,    ]    n1847588040 = 0x6E1FF4C8    v12 = b&#x22;&#x22;.join(p.to_bytes(8, &#x22;little&#x22;) for p in v12_parts)    v12 += n1847588040.to_bytes(4, &#x22;little&#x22;)    flag = invert_transform(v12)    print(&#x22;flag:&#x22;, flag)"><div></div></button></div></figure></div>
<blockquote>
<p><code>AEGIS{eA5y_wIn_Call64ck_function_sHeLl_c0de}</code></p>
</blockquote>
<h3 id="minielf">minielf</h3>
<p>:(((( 真的很bad</p>
<h2 id="pwn">Pwn</h2>
<h3 id="n2">n2</h3>
<p>從零開始pwn就從aegis開始🤡
這次是一個UAF的漏洞 前面跟 minielf 掙扎太久最後直接 vibe pwn
跟gpt一通操作到了可以注入但是會跑無限迴圈
後面重新分析了一下</p>
<p>首先它是一個heap的UAF 在找資料的時候有看這篇 感覺方向很接近 而且也都是菜單題—> <a href="https://blog.csdn.net/2301_79880752/article/details/136566776">[CTF]PWN—堆—UAF漏洞_pwn uaf-CSDN博客</a></p>
<p>總之思路的部分是: free large chunk -> leak libc -> 寫入 one_gadget -> 觸發 -> 拿到 interactive shell</p>
<details data-callout="" data-callout-type="quote" open>
<summary data-callout-title="">source code</summary>
<div data-callout-body="">
<p>主選單</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="c"><code><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">switch</span><span style="--0:#E1E4E8;--1:#24292E"> ( p_n4 )</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#F97583;--1:#BF3441">case</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">3</span><span style="--0:#E1E4E8;--1:#24292E">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">       </span><span style="--0:#B392F0;--1:#6F42C1">show_note</span><span style="--0:#E1E4E8;--1:#24292E">();</span></div></div><div class="ec-line"><div class="code"><span class="indent">       </span><span style="--0:#F97583;--1:#BF3441">break</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#F97583;--1:#BF3441">case</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">       </span><span style="--0:#B392F0;--1:#6F42C1">add_note</span><span style="--0:#E1E4E8;--1:#24292E">();</span></div></div><div class="ec-line"><div class="code"><span class="indent">       </span><span style="--0:#F97583;--1:#BF3441">break</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#F97583;--1:#BF3441">case</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">2</span><span style="--0:#E1E4E8;--1:#24292E">:</span></div></div><div class="ec-line"><div class="code"><span class="indent">       </span><span style="--0:#B392F0;--1:#6F42C1">backup_and_delete_note</span><span style="--0:#E1E4E8;--1:#24292E">();</span></div></div><div class="ec-line"><div class="code"><span class="indent">       </span><span style="--0:#F97583;--1:#BF3441">break</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="switch ( p_n4 )   {     case 3:       show_note();       break;     case 1:       add_note();       break;     case 2:       backup_and_delete_note();       break;"><div></div></button></div></figure></div>
<p>主要的 UAF 在 <code>backup_and _delete_note</code> 只有 free mem 沒有 free ptr, 所以指針還是指向記憶體</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="c"><code><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">unsigned</span><span style="--0:#E1E4E8;--1:#24292E"> __int64 </span><span style="--0:#B392F0;--1:#6F42C1">backup_and_delete_note</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(_QWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#FFAB70;--1:#AE4B07">p_size</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(_QWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)std::vector</span><span style="--0:#F97583;--1:#BF3441">&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">Note </span><span style="--0:#F97583;--1:#BF3441">*></span><span style="--0:#E1E4E8;--1:#24292E">::operator</span><span style="--0:#B392F0;--1:#6F42C1">[]</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">notes, </span><span style="--0:#FFAB70;--1:#AE4B07">p_size</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">]);</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> ( </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(_DWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)(</span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(_QWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#FFAB70;--1:#AE4B07">p_size</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">16</span><span style="--0:#F97583;--1:#BF3441">LL</span><span style="--0:#E1E4E8;--1:#24292E">) </span><span style="--0:#F97583;--1:#BF3441">&#x3C;=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">200</span><span style="--0:#F97583;--1:#BF3441">u</span><span style="--0:#E1E4E8;--1:#24292E"> )</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">{</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">     </span></span><span style="--0:#E1E4E8;--1:#24292E">v5 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> std::operator</span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">std::char_traits</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char>></span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">std::cout, </span><span style="--0:#9ECBFF;--1:#032F62">"Backing up note "</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">     </span></span><span style="--0:#E1E4E8;--1:#24292E">v6 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> std::ostream::operator</span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">(v5, </span><span style="--0:#FFAB70;--1:#AE4B07">p_size</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">]);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">     </span></span><span style="--0:#E1E4E8;--1:#24292E">v7 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> std::operator</span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">std::char_traits</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char>></span><span style="--0:#E1E4E8;--1:#24292E">(v6, </span><span style="--0:#9ECBFF;--1:#032F62">"..."</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">     </span></span><span style="--0:#E1E4E8;--1:#24292E">std::ostream::operator</span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">(v7, </span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">std::endl</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char</span><span style="--0:#E1E4E8;--1:#24292E">,std::char_traits</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char>></span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">     </span></span><span style="--0:#E1E4E8;--1:#24292E">v8 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> std::operator</span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">std::char_traits</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char>></span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">std::cout, </span><span style="--0:#9ECBFF;--1:#032F62">"Backup successful."</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">     </span></span><span style="--0:#E1E4E8;--1:#24292E">std::ostream::operator</span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">(v8, </span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">std::endl</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char</span><span style="--0:#E1E4E8;--1:#24292E">,std::char_traits</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char>></span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#99A0A6;--1:#616972">// free content &#x26; struct</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#B392F0;--1:#6F42C1">free</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">**</span><span style="--0:#E1E4E8;--1:#24292E">)(</span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(_QWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#FFAB70;--1:#AE4B07">p_size</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">8</span><span style="--0:#F97583;--1:#BF3441">LL</span><span style="--0:#E1E4E8;--1:#24292E">));</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#B392F0;--1:#6F42C1">free</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">**</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#FFAB70;--1:#AE4B07">p_size</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">]);</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#99A0A6;--1:#616972">// clear to null</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(_QWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)std::vector</span><span style="--0:#F97583;--1:#BF3441">&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">Note </span><span style="--0:#F97583;--1:#BF3441">*></span><span style="--0:#E1E4E8;--1:#24292E">::operator</span><span style="--0:#B392F0;--1:#6F42C1">[]</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">notes, </span><span style="--0:#FFAB70;--1:#AE4B07">p_size</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">]) </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">     </span></span><span style="--0:#E1E4E8;--1:#24292E">v9 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> std::operator</span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">std::char_traits</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char>></span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">std::cout, </span><span style="--0:#9ECBFF;--1:#032F62">"Note "</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">     </span></span><span style="--0:#E1E4E8;--1:#24292E">v10 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> std::ostream::operator</span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">(v9, </span><span style="--0:#FFAB70;--1:#AE4B07">p_size</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">]);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">     </span></span><span style="--0:#E1E4E8;--1:#24292E">v4 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> std::operator</span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">std::char_traits</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char>></span><span style="--0:#E1E4E8;--1:#24292E">(v10, </span><span style="--0:#9ECBFF;--1:#032F62">" deleted successfully."</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent">   </span><span style="--0:#F97583;--1:#BF3441">else</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">{</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">     </span></span><span style="--0:#E1E4E8;--1:#24292E">v3 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> std::operator</span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">std::char_traits</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char>></span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">std::cout, </span><span style="--0:#9ECBFF;--1:#032F62">"Backup failed: Note content is too large to backup."</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">     </span></span><span style="--0:#E1E4E8;--1:#24292E">std::ostream::operator</span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">(v3, </span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">std::endl</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char</span><span style="--0:#E1E4E8;--1:#24292E">,std::char_traits</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char>></span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#99A0A6;--1:#616972">// free content &#x26; note struct</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#B392F0;--1:#6F42C1">free</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">**</span><span style="--0:#E1E4E8;--1:#24292E">)(</span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(_QWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#FFAB70;--1:#AE4B07">p_size</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">8</span><span style="--0:#F97583;--1:#BF3441">LL</span><span style="--0:#E1E4E8;--1:#24292E">));</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#B392F0;--1:#6F42C1">free</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">**</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#FFAB70;--1:#AE4B07">p_size</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">]);</span></div></div><div class="ec-line"><div class="code"><span class="indent">     </span><span style="--0:#99A0A6;--1:#616972">// HERE DIDNT CLEAR TO NULL</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">     </span></span><span style="--0:#E1E4E8;--1:#24292E">v4 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> std::operator</span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">std::char_traits</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char>></span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">std::cout, </span><span style="--0:#9ECBFF;--1:#032F62">"Deletion aborted. Please try again later."</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">std::ostream::operator</span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">(v4, </span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">std::endl</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char</span><span style="--0:#E1E4E8;--1:#24292E">,std::char_traits</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char>></span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> v13 </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">__readfsqword</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">28</span><span style="--0:#F97583;--1:#BF3441">u</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="unsigned __int64 backup_and_delete_note(void){   *(_QWORD *)&#x26;p_size[1] = *(_QWORD *)std::vector<Note *>::operator[](&#x26;notes, p_size[0]);   if ( *(_DWORD *)(*(_QWORD *)&#x26;p_size[1] + 16LL) <= 0x200u )   {     v5 = std::operator<<<std::char_traits<char>>(&#x26;std::cout, &#x22;Backing up note &#x22;);     v6 = std::ostream::operator<<(v5, p_size[0]);     v7 = std::operator<<<std::char_traits<char>>(v6, &#x22;...&#x22;);     std::ostream::operator<<(v7, &#x26;std::endl<char,std::char_traits<char>>);     v8 = std::operator<<<std::char_traits<char>>(&#x26;std::cout, &#x22;Backup successful.&#x22;);     std::ostream::operator<<(v8, &#x26;std::endl<char,std::char_traits<char>>);     // free content &#x26; struct     free(*(void **)(*(_QWORD *)&#x26;p_size[1] + 8LL));     free(*(void **)&#x26;p_size[1]);     // clear to null     *(_QWORD *)std::vector<Note *>::operator[](&#x26;notes, p_size[0]) = 0;     v9 = std::operator<<<std::char_traits<char>>(&#x26;std::cout, &#x22;Note &#x22;);     v10 = std::ostream::operator<<(v9, p_size[0]);     v4 = std::operator<<<std::char_traits<char>>(v10, &#x22; deleted successfully.&#x22;);   }   else   {     v3 = std::operator<<<std::char_traits<char>>(&#x26;std::cout, &#x22;Backup failed: Note content is too large to backup.&#x22;);     std::ostream::operator<<(v3, &#x26;std::endl<char,std::char_traits<char>>);     // free content &#x26; note struct     free(*(void **)(*(_QWORD *)&#x26;p_size[1] + 8LL));     free(*(void **)&#x26;p_size[1]);     // HERE DIDNT CLEAR TO NULL     v4 = std::operator<<<std::char_traits<char>>(&#x26;std::cout, &#x22;Deletion aborted. Please try again later.&#x22;);   }   std::ostream::operator<<(v4, &#x26;std::endl<char,std::char_traits<char>>); } return v13 - __readfsqword(0x28u);}"><div></div></button></div></figure></div>
<p>然後在<code>show_note</code>只有驗證是否null指標 所以一樣可以存取到</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="c"><code><div class="ec-line"><div class="code"><span style="--0:#F97583;--1:#BF3441">unsigned</span><span style="--0:#E1E4E8;--1:#24292E"> __int64 </span><span style="--0:#B392F0;--1:#6F42C1">show_note</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">{</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(_QWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#FFAB70;--1:#AE4B07">p_size</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">__readfsqword</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">28</span><span style="--0:#F97583;--1:#BF3441">u</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">std::operator</span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">std::char_traits</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char>></span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">std::cout, </span><span style="--0:#9ECBFF;--1:#032F62">"Enter note index to show: "</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">std::istream::operator</span><span style="--0:#F97583;--1:#BF3441">>></span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">std::cin, p_size);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">v0 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">p_size</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">];</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#99A0A6;--1:#616972">// only checking null ptr</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> ( v0 </span><span style="--0:#F97583;--1:#BF3441">>=</span><span style="--0:#E1E4E8;--1:#24292E"> std::vector</span><span style="--0:#F97583;--1:#BF3441">&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">Note </span><span style="--0:#F97583;--1:#BF3441">*></span><span style="--0:#B392F0;--1:#6F42C1">::size</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">notes) </span><span style="--0:#F97583;--1:#BF3441">||</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">!*</span><span style="--0:#E1E4E8;--1:#24292E">(_QWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)std::vector</span><span style="--0:#F97583;--1:#BF3441">&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">Note </span><span style="--0:#F97583;--1:#BF3441">*></span><span style="--0:#E1E4E8;--1:#24292E">::operator</span><span style="--0:#B392F0;--1:#6F42C1">[]</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">notes, </span><span style="--0:#FFAB70;--1:#AE4B07">p_size</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">]) )</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">{</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">v2 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> std::operator</span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">std::char_traits</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char>></span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">std::cout, </span><span style="--0:#9ECBFF;--1:#032F62">"Invalid index or note already deleted."</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">else</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">{</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">v3 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E"> (</span><span style="--0:#F97583;--1:#BF3441">***</span><span style="--0:#E1E4E8;--1:#24292E">)(</span><span style="--0:#F97583;--1:#BF3441">void</span><span style="--0:#E1E4E8;--1:#24292E">))std::vector</span><span style="--0:#F97583;--1:#BF3441">&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">Note </span><span style="--0:#F97583;--1:#BF3441">*></span><span style="--0:#E1E4E8;--1:#24292E">::operator</span><span style="--0:#B392F0;--1:#6F42C1">[]</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">notes, </span><span style="--0:#FFAB70;--1:#AE4B07">p_size</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">]);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">**</span><span style="--0:#E1E4E8;--1:#24292E">v3)();</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">v4 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> std::operator</span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">std::char_traits</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char>></span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">std::cout, </span><span style="--0:#9ECBFF;--1:#032F62">"Content: "</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">v5 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> std::vector</span><span style="--0:#F97583;--1:#BF3441">&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">Note </span><span style="--0:#F97583;--1:#BF3441">*></span><span style="--0:#E1E4E8;--1:#24292E">::operator</span><span style="--0:#B392F0;--1:#6F42C1">[]</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">notes, </span><span style="--0:#FFAB70;--1:#AE4B07">p_size</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E">]);</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">   </span></span><span style="--0:#E1E4E8;--1:#24292E">v2 </span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> std::operator</span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">std::char_traits</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char>></span><span style="--0:#E1E4E8;--1:#24292E">(v4, </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(_QWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)(</span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(_QWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)v5 </span><span style="--0:#F97583;--1:#BF3441">+</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">8</span><span style="--0:#F97583;--1:#BF3441">LL</span><span style="--0:#E1E4E8;--1:#24292E">));</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#99A0A6;--1:#616972">// reading the content which already been released</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E"> </span></span><span style="--0:#E1E4E8;--1:#24292E">std::ostream::operator</span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E">(v2, </span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#E1E4E8;--1:#24292E">std::endl</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char</span><span style="--0:#E1E4E8;--1:#24292E">,std::char_traits</span><span style="--0:#F97583;--1:#BF3441">&#x3C;char>></span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span class="indent"> </span><span style="--0:#F97583;--1:#BF3441">return</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">(_QWORD </span><span style="--0:#F97583;--1:#BF3441">*</span><span style="--0:#E1E4E8;--1:#24292E">)</span><span style="--0:#F97583;--1:#BF3441">&#x26;</span><span style="--0:#FFAB70;--1:#AE4B07">p_size</span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E">] </span><span style="--0:#F97583;--1:#BF3441">-</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">__readfsqword</span><span style="--0:#E1E4E8;--1:#24292E">(</span><span style="--0:#F97583;--1:#BF3441">0x</span><span style="--0:#79B8FF;--1:#005CC5">28</span><span style="--0:#F97583;--1:#BF3441">u</span><span style="--0:#E1E4E8;--1:#24292E">);</span></div></div><div class="ec-line"><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="unsigned __int64 show_note(void){ *(_QWORD *)&#x26;p_size[1] = __readfsqword(0x28u); std::operator<<<std::char_traits<char>>(&#x26;std::cout, &#x22;Enter note index to show: &#x22;); std::istream::operator>>(&#x26;std::cin, p_size); v0 = p_size[0]; // only checking null ptr if ( v0 >= std::vector<Note *>::size(&#x26;notes) || !*(_QWORD *)std::vector<Note *>::operator[](&#x26;notes, p_size[0]) ) {   v2 = std::operator<<<std::char_traits<char>>(&#x26;std::cout, &#x22;Invalid index or note already deleted.&#x22;); } else {   v3 = (void (***)(void))std::vector<Note *>::operator[](&#x26;notes, p_size[0]);   (**v3)();   v4 = std::operator<<<std::char_traits<char>>(&#x26;std::cout, &#x22;Content: &#x22;);   v5 = std::vector<Note *>::operator[](&#x26;notes, p_size[0]);   v2 = std::operator<<<std::char_traits<char>>(v4, *(_QWORD *)(*(_QWORD *)v5 + 8LL)); } // reading the content which already been released std::ostream::operator<<(v2, &#x26;std::endl<char,std::char_traits<char>>); return *(_QWORD *)&#x26;p_size[1] - __readfsqword(0x28u);}"><div></div></button></div></figure></div>
</div>
</details>
<details data-callout="" data-callout-type="example" open>
<summary data-callout-title="">Background Check</summary>
<div data-callout-body="">
<p></p>
<div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="--0:#B392F0;--1:#6F42C1">┌──(kali㉿kali</span><span style="--0:#E1E4E8;--1:#24292E">)-[/media/sf_SHARED_FILE/AEGIS26/pwn/n2]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#B392F0;--1:#6F42C1">└─$</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">ldd</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">n2</span></div></div><div class="ec-line"><div class="code"><span class="indent">       </span><span style="--0:#B392F0;--1:#6F42C1">linux-vdso.so.1</span><span style="--0:#E1E4E8;--1:#24292E"> (0x00007f8996902000)</span></div></div><div class="ec-line"><div class="code"><span class="indent">       </span><span style="--0:#B392F0;--1:#6F42C1">libstdc++.so.6</span><span style="--0:#E1E4E8;--1:#24292E"> =</span><span style="--0:#F97583;--1:#BF3441">></span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">/lib/x86_64-linux-gnu/libstdc++.so.6</span><span style="--0:#E1E4E8;--1:#24292E"> (0x00007f8996600000)</span></div></div><div class="ec-line"><div class="code"><span class="indent">       </span><span style="--0:#B392F0;--1:#6F42C1">libc.so.6</span><span style="--0:#E1E4E8;--1:#24292E"> =</span><span style="--0:#F97583;--1:#BF3441">></span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">/lib/x86_64-linux-gnu/libc.so.6</span><span style="--0:#E1E4E8;--1:#24292E"> (0x00007f899640a000)</span></div></div><div class="ec-line"><div class="code"><span class="indent">       </span><span style="--0:#B392F0;--1:#6F42C1">libm.so.6</span><span style="--0:#E1E4E8;--1:#24292E"> =</span><span style="--0:#F97583;--1:#BF3441">></span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">/lib/x86_64-linux-gnu/libm.so.6</span><span style="--0:#E1E4E8;--1:#24292E"> (0x00007f899631a000)</span></div></div><div class="ec-line"><div class="code"><span class="indent">       </span><span style="--0:#B392F0;--1:#6F42C1">/lib64/ld-linux-x86-64.so.2</span><span style="--0:#E1E4E8;--1:#24292E"> (0x00007f8996904000)</span></div></div><div class="ec-line"><div class="code"><span class="indent">       </span><span style="--0:#B392F0;--1:#6F42C1">libgcc_s.so.1</span><span style="--0:#E1E4E8;--1:#24292E"> =</span><span style="--0:#F97583;--1:#BF3441">></span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">/lib/x86_64-linux-gnu/libgcc_s.so.1</span><span style="--0:#E1E4E8;--1:#24292E"> (0x00007f89968b5000)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#B392F0;--1:#6F42C1">┌──(kali㉿kali</span><span style="--0:#E1E4E8;--1:#24292E">)-[/media/sf_SHARED_FILE/AEGIS26/pwn/n2]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#B392F0;--1:#6F42C1">└─$</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">gdb-pwndbg</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">n2</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#B392F0;--1:#6F42C1">pwndbg</span><span style="--0:#E1E4E8;--1:#24292E">> </span><span style="--0:#9ECBFF;--1:#032F62">checksec</span></div></div><div class="ec-line"><div class="code"><span style="--0:#B392F0;--1:#6F42C1">File:</span><span style="--0:#E1E4E8;--1:#24292E">     </span><span style="--0:#9ECBFF;--1:#032F62">/media/sf_SHARED_FILE/AEGIS26/pwn/n2/n2</span></div></div><div class="ec-line"><div class="code"><span style="--0:#B392F0;--1:#6F42C1">Arch:</span><span style="--0:#E1E4E8;--1:#24292E">     </span><span style="--0:#9ECBFF;--1:#032F62">amd64</span></div></div><div class="ec-line"><div class="code"><span style="--0:#B392F0;--1:#6F42C1">RELRO:</span><span style="--0:#E1E4E8;--1:#24292E">      </span><span style="--0:#9ECBFF;--1:#032F62">Partial</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">RELRO</span></div></div><div class="ec-line"><div class="code"><span style="--0:#B392F0;--1:#6F42C1">Stack:</span><span style="--0:#E1E4E8;--1:#24292E">      </span><span style="--0:#9ECBFF;--1:#032F62">Canary</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">found</span></div></div><div class="ec-line"><div class="code"><span style="--0:#B392F0;--1:#6F42C1">NX:</span><span style="--0:#E1E4E8;--1:#24292E">         </span><span style="--0:#9ECBFF;--1:#032F62">NX</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">enabled</span></div></div><div class="ec-line"><div class="code"><span style="--0:#B392F0;--1:#6F42C1">PIE:</span><span style="--0:#E1E4E8;--1:#24292E">        </span><span style="--0:#9ECBFF;--1:#032F62">No</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">PIE</span><span style="--0:#E1E4E8;--1:#24292E"> (0x400000)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#B392F0;--1:#6F42C1">SHSTK:</span><span style="--0:#E1E4E8;--1:#24292E">      </span><span style="--0:#9ECBFF;--1:#032F62">Enabled</span></div></div><div class="ec-line"><div class="code"><span style="--0:#B392F0;--1:#6F42C1">IBT:</span><span style="--0:#E1E4E8;--1:#24292E">        </span><span style="--0:#9ECBFF;--1:#032F62">Enabled</span></div></div><div class="ec-line"><div class="code"><span style="--0:#B392F0;--1:#6F42C1">Stripped:</span><span style="--0:#E1E4E8;--1:#24292E">   </span><span style="--0:#9ECBFF;--1:#032F62">No</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="┌──(kali㉿kali)-[/media/sf_SHARED_FILE/AEGIS26/pwn/n2]└─$ ldd n2       linux-vdso.so.1 (0x00007f8996902000)       libstdc++.so.6 => /lib/x86_64-linux-gnu/libstdc++.so.6 (0x00007f8996600000)       libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f899640a000)       libm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007f899631a000)       /lib64/ld-linux-x86-64.so.2 (0x00007f8996904000)       libgcc_s.so.1 => /lib/x86_64-linux-gnu/libgcc_s.so.1 (0x00007f89968b5000)┌──(kali㉿kali)-[/media/sf_SHARED_FILE/AEGIS26/pwn/n2]└─$ gdb-pwndbg n2pwndbg> checksecFile:     /media/sf_SHARED_FILE/AEGIS26/pwn/n2/n2Arch:     amd64RELRO:      Partial RELROStack:      Canary foundNX:         NX enabledPIE:        No PIE (0x400000)SHSTK:      EnabledIBT:        EnabledStripped:   No"><div></div></button></div></figure></div>
</div>
</details>
<p>(先這樣 exploit晚點寫QQ)</p>  </div> </article> </main> <footer data-astro-cid-sz7xmlte> <div class="footer-content" data-astro-cid-sz7xmlte> <div class="copyright" data-astro-cid-sz7xmlte>
&copy; 2025 Obsidian Blogger. All rights reserved.
</div> </div> </footer>  <script type="module" src="/blogs/_astro/BlogPost.astro_astro_type_script_index_0_lang.DbtG32J1.js"></script> </body> </html>